
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>DateTime in F# - Jake Trent</title>

  <meta name="author" content="https://plus.google.com/115032056022257436849">
  
  <meta name="description" content="Should I use DateTime or DateTimeOffset for Utc or local time in F#?">
  <meta name="keywords" content="dotnet, .net, fsharp, f#, datetime, datetimeoffset, local, universal, utc">
  <meta name="copyright" content="http://creativecommons.org/licenses/by/3.0/us/" />

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="DateTime in F#" />
  <meta property="og:type" content="article" />
  <meta property="og:image" content="http://i.imgur.com/L5olAv0.png" />
  <meta property="og:url" content="http://jaketrent.com/post/datetime-in-fsharp/" />
  <meta property="og:description" content="Should I use DateTime or DateTimeOffset for Utc or local time in F#?" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="DateTime in F#" />
  <meta name="twitter:description" content="Should I use DateTime or DateTimeOffset for Utc or local time in F#?" />
  <meta name="twitter:image" content="http://i.imgur.com/L5olAv0.png" />

  
  <link rel="canonical" href="http://jaketrent.com/post/datetime-in-fsharp/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Jake Trent" type="application/atom+xml">
  <meta name="google-site-verification" content="uvx7BhaUTNz29nQgydsFPRsErfqYBhPEV_svnHvW7H0" />

<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-16224416-4']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <div class="container">
    <div class="sidebar">
      <section class="logo">
  <header class="logo-header">
    <h2 class="logo-title">
      <a class="logo-link" href="/">
        <span class="logo-img"></span>
      </a>
    </h2>
  </header>
</section>

      <nav class="main-nav" role="navigation"><ul class="main-nav-list">
  <li class="main-nav-item">
    <a class="main-nav-link" href="/">Blog</a>
  </li>
  <li class="main-nav-item">
    <a class="main-nav-link" href="/work">Work</a>
  </li>
  <li class="main-nav-item">
    <a class="main-nav-link" href="https://books.jaketrent.com">Books</a>
  </li>
  <li class="main-nav-item">
    <a class="main-nav-link" href="https://github.com/jaketrent">Github</a>
  </li>
  <li class="main-nav-item">
    <a class="main-nav-link" href="http://www.linkedin.com/in/jaketrent">LinkedIn</a>
  </li>
</ul>
</nav>
    </div>
    <div class="content">
      <div>
<article class="entry entry-detail" role="article">
  
  <header>
    
      <h1 class="entry-title">DateTime in F#</h1>
    
    
      <p class="meta">
        








  


<time datetime="2017-01-04T11:11:00-07:00" pubdate data-updated="true">Jan 4<span>th</span>, 2017</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>I&#8217;ve said jokingly, when coding through date/time-related problems, someone could do a PhD on this stuff.  Surely they have.  It can get complicated.  Here are a few core facts related to Utc time and the usage of .Net&#8217;s <code>System.DateTime</code> and <code>System.DateTimeOffset</code> classes that you may find useful.</p>

<p><img src="http://i.imgur.com/L5olAv0.png" alt="f#" /></p>

<!--more-->


<h2>Universal vs. Local Time</h2>

<p>Utc is universal time.  All hosts in the world can store a time in Utc and make comparisons between one another.  If your company had two hosts, one in Oregon and one in Hong Kong, and they did an operation at the exact same time, that time would be stored as the exact same value in Utc, or universal, time.  But the time value would be different locally, because there is a 16-hour time difference between what the local clock reads in Oregon vs Hong Kong at the moment of that operation.  If you want to make time comparisons or calculations or have interop between systems in different geographies, always use Utc time.</p>

<h2>System.DateTime</h2>

<p>In .Net, <code>System.DateTime</code> can represent many things.  It might be a local time construct or a Utc time or neither.  This is determined by its <a href="https://msdn.microsoft.com/en-us/library/shx7s921(v=vs.110).aspx"><code>System.DateTimeKind</code> member</a>.  When instantiated, <code>System.DateTime</code> is of kind <code>DateTimeKind.Unspecified</code>.  You must add an additional line of code, assigning the <code>DateTimeKind</code> using the static method of <code>DateTime.SpecifyKind</code>.  Using the <code>DateTimeKind</code>, you can make a <code>DateTime</code> Utc.</p>

<h2>System.DateTimeOffset</h2>

<p>In .Net, <code>System.DateTimeOffset</code> is a wrapper around a local <code>DateTime</code> and a <code>TimeSpan</code> offset from universal time.  (As a side note, the &#8220;Utc offset&#8221; is not the same as a time zone, even though the values might match up.  Time zone is a totally different construct with surrounding history and customs.)  The reason that it is a time <em>with</em> an offset is so that the original local time of the observer of the time (eg, Hong Kong host) can be stored <em>with</em> the offset from Utc at that moment, which allows it to represent a universal time as well.  Thus, <code>DateTimeOffset</code> can store <em>more</em> information: the local time and the offset that allows conversion to Utc time.</p>

<p>Interestingly, however, one can erase this local time storage by using <code>System.DateTimeOffset.UtcNow</code> when trying to instantiate an object that is &#8220;the current time&#8221;.  The current time that will be stored is the Universal time or the time in Greenwich, England (offset of +00:00).  You lose the local time storage.  <code>System.DateTimeOffset</code> can give you the best of both worlds if you store &#8220;the current time&#8221; using <code>System.DateTimeOffset.Now</code>, keeping a local time and also the offset to Utc, allowing easy conversion to universal time.</p>

<h2>Which is Best?</h2>

<p>Which one you should use isn&#8217;t as clear.</p>

<p><code>DateTime</code> requires 2 steps before it&#8217;s clear what time it is.  This can require discipline that we might not want to give to our developers.</p>

<p><code>DateTimeOffset</code> infers a knowledge about Utc, because it includes an offset to Utc.  Thus Utc can always be determined from this object.  But transport of the <code>DateTimeOffset</code> to another system, such as a database, might not store the offset, effectively stripping it.  Before it was stripped, did you convert to Utc or is it still local time?  And after you query the data, how do you know what time it is?  So you might like the combo of <code>Sytem.DateTimeOffset</code> knowing about local time <em>and</em> the offset, but the potentially of handling this data in translation might make you think twice.</p>

<p>It does seem clear that it&#8217;s easy to become unclear about what your dates mean.  Organizations, especially those with multiple systems that need to interop with dates and times, need to put forth effort to be clear about how they&#8217;ll approach this.  Interoperating systems to need to handle dates and times consistently.  This should be written down and documented.  Guides for your approach should be shared for your tech stacks.</p>

<p>What date/time objects do you use and why?  How do you keep these straight between your systems?</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jake Trent</span></span>

      








  


<time datetime="2017-01-04T11:11:00-07:00" pubdate data-updated="true">Jan 4<span>th</span>, 2017</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/code/'>Code</a>, <a class='category' href='/blog/categories/dotnet/'>dotnet</a>, <a class='category' href='/blog/categories/fsharp/'>fsharp</a>, <a class='category' href='/blog/categories/functional-programming/'>functional-programming</a>
  
</span>


    </p>
    
      
    
    <p class="meta">
      
        <a class="prev-article-link" href="/post/debug-log-in-elm-pipes/" title="Previous Post: Debug.log in Elm Pipes">&laquo; Debug.log in Elm Pipes</a>
      
      
        <a class="next-article-link" href="/post/deploy-create-react-app-heroku-node/" title="Next Post: Deploy create-react-app to Heroku on Node.js">Deploy create-react-app to Heroku on Node.js &raquo;</a>
      
    </p>
  </footer>
</article>

  <section class="comments">
    <h2 class="comments-title">Comments</h2>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

    </div>
  </div>
  <div class="footer-container">
    <footer class="main-footer" role="contentinfo"><div class="main-footer-logo"></div>
<ul class="main-footer-links-list">
  <li class="main-footer-links-item">
    <span class="main-footer-verbage">Content licensed</span> 2017 <a href="http://creativecommons.org/licenses/by/3.0/us/">CC 3.0 Attribution</a>
  </li>
  <li class="main-footer-links-item">
    <span class="main-footer-verbage">Authored by </span><a href="https://plus.google.com/115032056022257436849?rel=author">Jake Trent</a>
  </li>
  <li class="main-footer-links-item">
    <span class="main-footer-verbage">Subscribe to the </span><a href="/atom.xml">Feed</a>
  </li>
  <li class="main-footer-links-item main-footer-links-item-extra">
    <a href="/sitemap.xml">Sitemap</a>
  </li>
  <li class="main-footer-links-item main-footer-links-item-extra">
    <a href="https://github.com/jaketrent/jaketrent-blog/issues/new">Report a Bug</a>
  </li>
  <li class="main-footer-links-item main-footer-links-item-extra">
    <span class="main-footer-verbage">Chat on </span><a href="https://keybase.io/jaketrent">Keybase</a>
  </li>
  <li class="main-footer-links-item main-footer-links-item-extra">
    <span class="main-footer-verbage">Powered by </span><a href="http://octopress.org">Octopress</a>
  </li>
</ul>

</footer>
  </div>
  

<script type="text/javascript">
      var disqus_shortname = 'jaketrent';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://jaketrent.com/post/datetime-in-fsharp/';
        var disqus_url = 'http://jaketrent.com/post/datetime-in-fsharp/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





</body>
</html>
