<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: hql | Jake Trent]]></title>
  <link href="http://jaketrent.com/blog/categories/hql/atom.xml" rel="self"/>
  <link href="http://jaketrent.com/"/>
  <updated>2016-08-22T15:56:20-06:00</updated>
  <id>http://jaketrent.com/</id>
  <author>
    <name><![CDATA[Jake Trent]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Inner Joins in JPQL Delete Statements ]]></title>
    <link href="http://jaketrent.com/post/inner-joins-jpql-delete-statements/"/>
    <updated>2009-04-29T11:46:00-06:00</updated>
    <id>http://jaketrent.com/post/inner-joins-jpql-delete-statements</id>
    <content type="html"><![CDATA[<p>I'm working on a project that utilizes JPA/Hibernate as its ORM.  I was writing a few named queries for an JPQL/HQL delete and was getting an SQLGrammarException.  I soon found out that I couldn't use inner joins on a delete statement, even at the SQL level.  Here's the query transformation:</p>

<!--more-->


<p>I originally had this query:</p>

<p>```java
@NamedQuery(name = Queue.REMOVE_ROWS_OF_EARLY_RELEASE_REASON,
   query = "delete from Queue q " +</p>

<pre><code>       "where  q.enabledMember = :enabledMember " +
       "and    q.letter.eventReason.event.type = :eventType " +
       "and    q.letter.eventReason.reason = :reason ")
</code></pre>

<p>```</p>

<p>It had to evolve to this:</p>

<p>```java
@NamedQuery(name = Queue.REMOVE_ROWS_OF_EARLY_RELEASE_REASON,
   query = "delete from Queue q " +</p>

<pre><code>       "where q in (select sq from Queue sq " +
       "            where  sq.enabledMember = :enabledMember " +
       "            and    sq.letter.eventReason.event.type = :eventType " +
       "            and    sq.letter.eventReason.reason = :reason )"
</code></pre>

<p>```</p>

<p>The only solution that I could think of in order to keep the filter that I need was to use a subquery.  Anyone know of any other awesome solutions?</p>
]]></content>
  </entry>
  
</feed>
