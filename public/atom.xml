<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Jake Trent]]></title>
  <link href="http://jaketrent.com/atom.xml" rel="self"/>
  <link href="http://jaketrent.com/"/>
  <updated>2013-08-02T13:28:56-06:00</updated>
  <id>http://jaketrent.com/</id>
  <author>
    <name><![CDATA[Jake Trent]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Ember Dynamic Classes]]></title>
    <link href="http://jaketrent.com/post/ember-dynamic-classes/"/>
    <updated>2013-08-02T13:02:00-06:00</updated>
    <id>http://jaketrent.com/post/ember-dynamic-classes</id>
    <content type="html"><![CDATA[<p>In Ember, your state is separated from the UI inside models.  But, often you want the state of your models to be represented visually in the UI via dynamic class names.  Make it happen with <code>Ember.View</code>s.</p>

<p><img src="http://i.imgur.com/85v8PQP.png" alt="Dynamic Classes with Ember Views" /></p>

<!--more-->


<h2>Use an Ember.View</h2>

<p>A view will function as the translation layer between the state of your models and the DOM.  It will provide the logic to observe the properties within your model and expose it as a class name on the associated DOM element.</p>

<p>If I have a model with state:</p>

<figure class='code'><figcaption><span>my-model.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">App.MyModel = </span><span class="nx">App</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span>
</span><span class='line'>  <span class="nv">hasSomeState: </span><span class="kc">true</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Use classNameBindings</h2>

<p>Based on that state, I want to add a <code>has-some-state</code> class to the UI if it&#8217;s true, and remove the class if it&#8217;s false.  The view might look like:</p>

<figure class='code'><figcaption><span>my-model-view.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">App.MyModelView = </span><span class="nx">Ember</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'>  <span class="nv">classNameBindings: </span><span class="p">[</span><span class="s">&#39;hasSomeState&#39;</span><span class="p">]</span>
</span><span class='line'>  <span class="nv">hasSomeState: </span><span class="p">(</span><span class="o">-&gt;</span>
</span><span class='line'>    <span class="nx">@get</span><span class="p">(</span><span class="s">&#39;content&#39;</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;hasSomeState&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">).</span><span class="nx">property</span><span class="p">(</span><span class="s">&#39;content.hasSomeState&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>hasSomeState</code> function will return a boolean has to whether or not the <code>has-some-state</code> class should be added to the element.</p>

<h2>Bind to Model Properties</h2>

<p>Now use the view in the template, being careful to match the binding of <code>content</code> so the property watching works:</p>

<figure class='code'><figcaption><span>template-fragment.jade</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'>App.MyModelView contentBinding=&quot;this.myModelInstance&quot;
</span></code></pre></td></tr></table></div></figure>


<p>In the example, make sure <code>myModelInstance</code> is available in the scope of your route/controller.</p>

<p>As your model&#8217;s <code>hasSomeState</code> value is changed internally with the <code>@set</code> function, the view will be notified that it needs to re-run the <code>hasSomeState</code> function, and the UI will update if needed.</p>

<p>What other methods do you utilize in Ember to get dynamic classes?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Style File Input]]></title>
    <link href="http://jaketrent.com/post/style-file-input/"/>
    <updated>2013-07-23T16:44:00-06:00</updated>
    <id>http://jaketrent.com/post/style-file-input</id>
    <content type="html"><![CDATA[<p>File input fields are notoriously painful to style.  Here are a few quick tips to that will save you some dead ends.</p>

<p><img src="http://i.imgur.com/sm1b2ok.jpg" alt="File input" /></p>

<!--more-->


<h2>The Problem with File Inputs</h2>

<p>File inputs are inconsistent to start with.  They differ even in their native form across all browsers.  They also have internal elements that are not individually accessible, such as the &#8220;Browse&#8221; button.  They are also subject to more browser-imposed security constraints than input fields of other types.</p>

<p>Given these inherent problems/constraints, try to follow two basic rules:</p>

<ol>
<li>Don&#8217;t expect to make your file input look exactly like you&#8217;d like</li>
<li>Don&#8217;t trigger clicks on the file input</li>
</ol>


<h2>Styling the File Input</h2>

<p>Why is file input rule reasonable?  Shouldn&#8217;t you be able to match the UI design you desire?  Yes, on both counts.</p>

<p>Don&#8217;t style the file input to make it look like a photo upload button (or whatever you&#8217;re marking).  Instead, <strong>hide it</strong>.  And after you hide it, position it <strong>over</strong> another another element, such as a <code>div</code>, that you can style much more easily to look like the UI you envision.</p>

<p>Here is some example css on how you might accomplish this:</p>

<figure class='code'><figcaption><span>fileinput.jade</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="nc">.file-wrapper</span>
</span><span class='line'>  <span class="nc">.file-input</span>(<span class="na">type=</span><span class="s">&quot;file&quot;</span>)
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>fileinput.styl</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='sass'><span class='line'><span class="nc">.file-wrapper</span>
</span><span class='line'>  <span class="na">position</span><span class="o">:</span> <span class="no">relative</span>
</span><span class='line'>  <span class="na">overflow</span><span class="o">:</span> <span class="no">hidden</span>
</span><span class='line'>  <span class="na">cursor</span><span class="o">:</span> <span class="no">pointer</span>
</span><span class='line'>
</span><span class='line'><span class="nc">.file-input</span>
</span><span class='line'>  <span class="na">position</span><span class="o">:</span> <span class="no">absolute</span>
</span><span class='line'>  <span class="na">top</span><span class="o">:</span> <span class="mi">0</span>
</span><span class='line'>  <span class="na">right</span><span class="o">:</span> <span class="mi">0</span>
</span><span class='line'>  <span class="na">z-index</span><span class="o">:</span> <span class="mi">2</span>
</span><span class='line'>  <span class="na">opacity</span><span class="o">:</span> <span class="mi">0</span><span class="mf">.01</span>
</span><span class='line'>  <span class="na">height</span><span class="o">:</span> <span class="mi">100</span><span class="kt">%</span>
</span><span class='line'>  <span class="na">font-size</span><span class="o">:</span> <span class="mi">150</span><span class="kt">px</span>
</span></code></pre></td></tr></table></div></figure>


<p>The add additional styles to <code>.file-wrapper</code> to make it look as you wish.  Remember any vendor prefixes you may/not need for <code>opacity</code>, etc.</p>

<h2>Handling Double Clicks in IE</h2>

<p>It&#8217;s important to position the <code>.file-input</code> as <code>right: 0</code>.  Otherwise, in IE the file input field will not activate on a single click.  Instead it&#8217;ll need a double click.  This is because in IE clicking on the text box portion of the file input requires a double click.  Clicking on the browse button requires just a single click.  And the browse button is on the right side of the file input field in IE.  Finally, make the <code>font-size</code> big enough that you&#8217;re guaranteed to cover the <code>.file-wrapper</code> area.</p>

<h2>Handling Clicks</h2>

<p>Now you don&#8217;t need to have JavaScript to trigger click events on the file input field.  You will just be relying on direct user interaction to click the native file input field.  This will make <a href="http://stackoverflow.com/questions/210643/in-javascript-can-i-make-a-click-event-fire-programmatically-for-a-file-input">some browsers</a>, like Chrome and Firefox, happy.  This is because these browsers won&#8217;t hold file values given to the input programmatically as a security precaution.  Oddly, IE, which sometimes balks more about innane security constraints like this, is ok.</p>

<p>So, what do you think?  Does this work for you?  Anything else to make the solution more solid?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[So Good They Can't Ignore You]]></title>
    <link href="http://jaketrent.com/post/so-good-they-cant-ignore-you/"/>
    <updated>2013-07-17T22:35:00-06:00</updated>
    <id>http://jaketrent.com/post/so-good-they-cant-ignore-you</id>
    <content type="html"><![CDATA[<p>&#8220;<a href="http://www.amazon.com/gp/product/1455509124/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1455509124&amp;linkCode=as2&amp;tag=jaktre-20">So Good They Can&#8217;t Ignore You</a>&#8221; is written by Cal Newport.  He rejects the idea of following your passion in order to find the work you love.  Instead, he suggests the accumulation of career capital.</p>

<p><img src="http://i.imgur.com/VWjzM2c.jpg" alt="So good" /></p>

<!--more-->


<p>What follows are the main sections or rules of the book with a few of my takeaways each.  The man is obviously steeped in science.  The book reads like laws of physics.  Well, not quite that dry, but just as precise and well organized.  I love reading him say, &#8220;In which I argue&#8230;&#8221;  Sounds very professorish.</p>

<h2>The Passion Hypothesis</h2>

<p>Isn&#8217;t it true that when someone is trying to determine a career path or job, we often ask questions like, &#8220;Well, what do you want to do?&#8221; And give advice like, &#8220;Do something you&#8217;re passionate about.&#8221;  The author gives a few individual profiles of people who followed this advice without key ingredients and were, in the end, disappointed by the result.  He also points out a whole class of lifestyle designers who, in their delusion, <a href="http://jaketrent.com/post/quitter-review/">quit their day job</a> to live on their yet-to-be-created passive Internet income and aren&#8217;t able to make it.</p>

<h2>Career Capital</h2>

<p>(In which) Newport argues that &#8220;working right trumps finding the right work.&#8221;  Essentially, you worry more about what you are producing and the value you&#8217;re giving (craftsman mindset) instead of whether or not it fits some passion you&#8217;re predisposed to.</p>

<p>Career capital is essentially the collection of rare and valuable skills that you possess that the market is willing to pay for.  Without this, you will likely not enjoy your work.  With this, your ability to define and magnify your work is much greater.</p>

<p>The title of the book comes from Steve Martin, who remarked in an interview that aspiring comics didn&#8217;t like his advice.  They wanted quick fix answers like, &#8220;How do I get an audition?&#8221;  But he would always advise, &#8220;Be so good they can&#8217;t ignore you.&#8221;  And most likely, judging by your name recognition of Monseiur Martin, he has worked himself to that level.</p>

<h2>Autonomy</h2>

<p>It is autonomy, not passion, that is most likely to help you love your work.  The amount of control you have in a job is likely to influence your liking it.  The more control, the better.  But, it doesn&#8217;t come immediately.  If you don&#8217;t have the career capital, you can&#8217;t purchase it.  And if you&#8217;re offered it, while you know you probably don&#8217;t have the capital, it&#8217;s probably a mirage.  But if you&#8217;re so good they can&#8217;t ignore you, your ability to set terms and influence your environment is real.</p>

<h2>Importance of a Mission</h2>

<p>&#8220;So good they can&#8217;t ignore you&#8221; hardly sounds like your average work.  Instead it&#8217;s likely that you&#8217;re attached to a catchy mission.  You have a vision that people want to share.  You do work that people like to talk about.  Your name is known by peers and leaders in your industry.  You have made it to the edge of your field.  You are pushing boundaries, and are creating new fields, often mixtures of those you have expertise within.</p>

<p>These stages of achievement that push your career and humanity forward are significant.  Little steps or bets need to be made strategically and intentionally in order to create a habit of advancing your knowledge and skill.  The sheer investment required to get to these levels is immense.</p>

<h2>Conclusions</h2>

<p>Newport&#8217;s book was worth the read.  In fact, I recommend it to anyone about to enter college, desiring to start in a new field, wanting to scratch an entrepreneurial itch, or thinking of changing jobs.</p>

<p>His advice is solid.  It&#8217;s more grounded and nuanced than the &#8220;follow your passion&#8221;, feel good propaganda.</p>

<p>The writing is a little dry.  It&#8217;s a short book at just over 200 small pages.  Still, it took me a bit to get through.  I wasn&#8217;t exactly glued to the pages.  But I do believe the advice is invaluable if it influences one to throw all their potential ability behind producing their best work and becoming their best worker.  It reads well, but sometimes feels like a textbook.  Perfect for all that intentional learning we all want to do, right?</p>

<p>Most importantly, it inspired me to be so good they can&#8217;t ignore me.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Namespacing Angular Controller Attributes]]></title>
    <link href="http://jaketrent.com/post/namespacing-angular-controller-attributes/"/>
    <updated>2013-07-10T18:17:00-06:00</updated>
    <id>http://jaketrent.com/post/namespacing-angular-controller-attributes</id>
    <content type="html"><![CDATA[<p>Usually attributes of your Angular controllers are not namespaced.  But you can namespace them.  But you might not want to.</p>

<p><img src="http://i.imgur.com/wVBKD.png" alt="AngularJs controller namespacing" /></p>

<!--more-->


<h2>Angular Controllers Usually Attach Attributes to Scope</h2>

<p>Usually attributes in an Angular controller, such as functions and variables, are attached to the <code>$scope</code> object.  That looks like this:</p>

<figure class='code'><figcaption><span>my-ctrl.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s">&#39;myapp&#39;</span><span class="p">).</span><span class="nx">controller</span> <span class="s">&#39;MyCtrl&#39;</span><span class="p">,</span> <span class="nf">($scope) -&gt;</span>
</span><span class='line'>  <span class="nv">$scope.myVar = </span><span class="s">&#39;myVal&#39;</span>
</span><span class='line'>  <span class="nv">$scope.myFn = </span><span class="o">-&gt;</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;does stuff&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then in my template I don&#8217;t know, nor do I need to know, where the attribute comes from.  I just reference it:</p>

<figure class='code'><figcaption><span>my-app.jade</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'>html(ng-app=&quot;myapp&quot;)
</span><span class='line'>  body(ng-controller=&quot;MyCtrl&quot;)
</span><span class='line'>    h1 My Var: 
</span><span class='line'>    button(ng-click=&quot;myFun()&quot;) Does Stuff
</span></code></pre></td></tr></table></div></figure>


<h2>Namespaced Angular Controller Attributes</h2>

<p>In this simple example, this is no big deal.  But as your app grows in complexity with many, nested controllers and templates, it can become difficult to read the code.  If you have common function names, it might be hard to tell which controller&#8217;s function is referenced in your templates.  To make this less of a problem and the code more clear, you might namespace your controller attributes in the template.</p>

<p>To do this, you can write your controllers to attach attributes to the controller instead of scope and then put the controller itself on scope.  That looks like this:</p>

<figure class='code'><figcaption><span>my-ctrl.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s">&#39;myapp&#39;</span><span class="p">).</span><span class="nx">controller</span> <span class="s">&#39;MyCtrl&#39;</span><span class="p">,</span> <span class="nf">($scope) -&gt;</span>
</span><span class='line'>  <span class="vi">@myVar = </span><span class="s">&#39;myVal&#39;</span>
</span><span class='line'>  <span class="vi">@myFn = </span><span class="o">-&gt;</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;does stuff&#39;</span>
</span><span class='line'>  <span class="nv">$scope.MyCtrl = </span><span class="nx">@</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then your template changes to look like this:</p>

<figure class='code'><figcaption><span>my-app.jade</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'>html(ng-app=&quot;myapp&quot;)
</span><span class='line'>  body(ng-controller=&quot;MyCtrl&quot;)
</span><span class='line'>    h1 My Var: 
</span><span class='line'>    button(ng-click=&quot;MyCtrl.myFun()&quot;) Does Stuff
</span></code></pre></td></tr></table></div></figure>


<p>It&#8217;s kind of nice for the reasons stated above.  I saw this strategy referenced on the Interwebs at one point and thought it seemed like a good idea.</p>

<h2>Why You Might Avoid This</h2>

<p>Maybe you love the idea.  Maybe you don&#8217;t.  I thought I did.  I have been writing controllers this way for a while.  Now I don&#8217;t.  Here&#8217;s why:</p>

<h3>1. It Makes Templates Less Reusable</h3>

<p>It&#8217;s quite probable that I&#8217;ll have templates that I don&#8217;t want permanently attached to a specific controller.  An example I ran into recently was on a profile page.  I had two pages to show profiles: one for my profile and one for an arbitrary person in the system.  They looked the same in the UI.  They had the same basic functions.  But the source of data for the variables and the implementation of the functions was different in the two scenarios.  Thus, I had to refactor to remove the namespacing to be able to reuse the template across pages.</p>

<h3>2. It&#8217;s More Typing</h3>

<p>It&#8217;s silly.  It adds up.  The less superfluous typing I can do, the more I consider that solution.</p>

<h3>3. The Creators Don&#8217;t Do It</h3>

<p>I haven&#8217;t seen this strategy featured in official tutorials, guides, or API examples.  Not that the Angular d00ds have all the ideas or do everything right &#8211; it just isn&#8217;t a pattern I see widely accepted or used.</p>

<p>These days, I don&#8217;t namespace my controller attributes, and I don&#8217;t recommend it.</p>

<p>So what do you think?  Do you write your controllers this way?  Good idea?  Bad idea?  What are some alternative methods you&#8217;ve found to balance template reuse with readability?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Behavior of CoffeeScript Fat Arrow]]></title>
    <link href="http://jaketrent.com/post/behavior-of-coffeescript-fat-arrow/"/>
    <updated>2013-07-01T07:39:00-06:00</updated>
    <id>http://jaketrent.com/post/behavior-of-coffeescript-fat-arrow</id>
    <content type="html"><![CDATA[<p>In CoffeeScript there are two different types of arrows for defining functions:  arrow (<code>-&gt;</code>) and fat arrow or hash rocket (<code>=&gt;</code>).  Usually, you&#8217;ll use the regular arrow.  But sometimes you&#8217;ll want the special behavior of the fat arrow.</p>

<p><img src="http://i.imgur.com/nGd04zX.jpg" alt="CoffeeScript fat arrow" /></p>

<!--more-->


<h2>Function Binding</h2>

<p>In JavaScript, the keyword <code>this</code> within a function refers to the thing that the function is attached to.  Since functions can be invoked in various ways in an average application, what <code>this</code> actually references will change.</p>

<p>For instance, if a function is invoked as a callback in an event handler, <code>this</code> within that handler will likely reference <code>window</code> in JavaScript running within a web browser.  Often, this is not the desired reference.</p>

<p>The solution in vanilla JavaScript is to save a reference to the context the function is defined within and then use that reference in lieu of the <code>this</code> keyword.  My favorite name to save the <code>this</code> reference into is called <code>self</code>.  In JavaScript, that might look like:</p>

<figure class='code'><figcaption><span>manual-reference.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">this</span><span class="p">.</span><span class="nx">myVal</span> <span class="o">=</span> <span class="s2">&quot;my val&quot;</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">myFn</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">myVal</span><span class="p">);</span> <span class="c1">// will print &quot;my val&quot;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>CoffeeScript Function Binding</h2>

<p>CoffeeScript understands this basic need and makes the reference saving even easier.  When you use the fat arrow, or hash rocket, it will perform function binding.  It uses a variable called <code>_this</code> automatically.</p>

<h3>CoffeeScript Binding Rules</h3>

<ol>
<li>When a fat arrow is used to bind a function, a <code>_this</code> reference is saved in the same context as the function that was declared.</li>
<li>When properties of <code>this</code> are accessed inside the bound function, they will use the saved <code>_this</code> reference (e.g., <code>@myVal</code> would compile to <code>_this.myVal</code>).</li>
<li>When fat arrows are used to bind functions nested within bound functions, the <code>_this</code> reference from the top-level bound function context is used in the nested bound functions.</li>
<li>The deepest non-bound function context will be used to save a <code>_this</code> reference when a bound function is declared.</li>
</ol>


<h2>When to use Fat Arrow</h2>

<p>Given that, here are the every day rules on when to use the fat arrow:</p>

<ol>
<li>If the context of <code>this</code> in you function could change based on how it was invoked but properties of <code>this</code> need to always reference the context where the function was created, declare the function with a fat arrow.</li>
<li>If nested functions exhibit the same need as in rule #1, declare them with the fat arrow.</li>
<li>Don&#8217;t bind, then not bind, then bind again in nested functions.  The inner binding will clobber the <code>_this</code> reference and will likely not be what you expect in the outer context (see the last example below).</li>
</ol>


<h2>A Swirl of Examples</h2>

<p>Here are a bunch of examples of bound and non-bound functions.  The first code snippet is the CoffeeScript source.  The second code snippet is the compiled JavaScript.</p>

<h3>No Bound Functions</h3>

<p>Just regular CoffeeScript function declarations.</p>

<figure class='code'><figcaption><span>non-bound.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">myVal: </span><span class="s">&#39;my val&#39;</span>
</span><span class='line'><span class="nv">myNonBoundFn: </span><span class="o">-&gt;</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">@myVal</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>non-bound.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">({</span>
</span><span class='line'>  <span class="nx">myVal</span><span class="o">:</span> <span class="s1">&#39;my val&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">myNonBoundFn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">myVal</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Bound Function</h3>

<p>Introduced the fat arrow</p>

<figure class='code'><figcaption><span>bound.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">myVal: </span><span class="s">&#39;my val&#39;</span>
</span><span class='line'><span class="nv">myBoundFn: </span><span class="o">=&gt;</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">@myVal</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>bound.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">({</span>
</span><span class='line'>  <span class="nx">myVal</span><span class="o">:</span> <span class="s1">&#39;my val&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">myBoundFn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">myVal</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Bound, Non-bound Inner Function</h3>

<p>Notice the inner function is not bound, and defaults back to just referencing <code>this</code>.</p>

<figure class='code'><figcaption><span>non-bound-inner.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">myVal: </span><span class="s">&#39;my val&#39;</span>
</span><span class='line'><span class="nv">myBoundFn: </span><span class="o">=&gt;</span>
</span><span class='line'>  <span class="nv">myInnerNonBoundFn = </span><span class="o">-&gt;</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">@myVal</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>non-bound-inner.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">({</span>
</span><span class='line'>  <span class="nx">myVal</span><span class="o">:</span> <span class="s1">&#39;my val&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">myBoundFn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">myInnerNonBoundFn</span><span class="p">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">myInnerNonBoundFn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">myVal</span><span class="p">);</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Bound Within Bound Functions</h3>

<p>Inner bound function uses top-level <code>_this</code>.</p>

<figure class='code'><figcaption><span>bound-in-bound.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">myVal: </span><span class="s">&#39;my val&#39;</span>
</span><span class='line'><span class="nv">myBoundFn: </span><span class="o">=&gt;</span>
</span><span class='line'>  <span class="nv">myInnerBoundFn = </span><span class="o">=&gt;</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">@myVal</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>bound-in-bound.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">({</span>
</span><span class='line'>  <span class="nx">myVal</span><span class="o">:</span> <span class="s1">&#39;my val&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">myBoundFn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">myInnerBoundFn</span><span class="p">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">myInnerBoundFn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">myVal</span><span class="p">);</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Bound, Non-bound, then Bound Functions</h3>

<p>When <code>myVeryInnerBoundFn</code> uses the fat arrow inside of <code>myInnerNonBoundFn</code>, which does not, <code>_this = this</code> is generated again.  And when <code>myOtherBoundFn</code> is called, the <code>@what</code> property will be <code>undefined</code>.</p>

<figure class='code'><figcaption><span>clobber-this.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">myVal: </span><span class="s">&#39;my val&#39;</span>
</span><span class='line'><span class="nv">what: </span><span class="s">&#39;is this?&#39;</span>
</span><span class='line'><span class="nv">myBoundFn: </span><span class="o">=&gt;</span>
</span><span class='line'>  <span class="nv">myInnerNonBoundFn = </span><span class="o">-&gt;</span>
</span><span class='line'>    <span class="nv">myVeryInnerBoundFn = </span><span class="o">=&gt;</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">@myVal</span>
</span><span class='line'><span class="nv">myOtherBoundFn: </span><span class="o">=&gt;</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">@what</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>clobber-this.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">({</span>
</span><span class='line'>  <span class="nx">myVal</span><span class="o">:</span> <span class="s1">&#39;my val&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">what</span><span class="o">:</span> <span class="s1">&#39;is this?&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">myBoundFn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">myInnerNonBoundFn</span><span class="p">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">myInnerNonBoundFn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">myVeryInnerBoundFn</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">_this</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">myVeryInnerBoundFn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">myVal</span><span class="p">);</span>
</span><span class='line'>      <span class="p">};</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">myOtherBoundFn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">_this</span><span class="p">.</span><span class="nx">what</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Access Model in Ember View]]></title>
    <link href="http://jaketrent.com/post/access-model-in-ember-view/"/>
    <updated>2013-07-01T07:39:00-06:00</updated>
    <id>http://jaketrent.com/post/access-model-in-ember-view</id>
    <content type="html"><![CDATA[<p>Ember Views are used for event handling and creating reusable web components.  To make them useful and interesting, model data needs to make it into and out of the view.  Here is an example of how this works.</p>

<p><img src="http://i.imgur.com/RGKiJ0n.jpg" alt="Access model data in Ember View" /></p>

<!--more-->


<h2>Define Your View</h2>

<p>In our example, I&#8217;m making a simple dice rolling game.  I want to use a view to represent the die on the screen and to handle the roll event.  Your custom view must simply extend <code>Ember.View</code>:</p>

<figure class='code'><figcaption><span>die-view.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">App.DieView = </span><span class="nx">Ember</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span>
</span><span class='line'>  <span class="nv">templateName: </span><span class="s">&#39;die&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is about the simplest view definition we could make.  We&#8217;ll make it a bit cooler later.  For now, the view just knows where to get its markup.  The <code>die</code> template can be any valid template.  Ember, by default, uses Handlebars templates.  I prefer <a href="http://emblemjs.com/">Emblem</a> templates:</p>

<figure class='code'><figcaption><span>die.emblem</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'>li.die = die
</span></code></pre></td></tr></table></div></figure>


<p>This template will simply print the <code>die</code> object in an <code>li</code> with class of <code>die</code>.  (There are an unusual number of &#8216;die&#8217; references are in this example.  This is for purely entertainment reasons, nothing more nefarious. :)</p>

<h2>Render Data in Ember View Template</h2>

<p>Next, you need to get your Ember View referenced in your template markup.  In <a href="http://emblemjs.com/syntax/">Emblem</a>, to reference a view, start the line with a capital letter, specifically the name of your view.  In this view, I list the dice in my game controller <code>rolling</code> array and render each die in the <code>DieView</code></p>

<figure class='code'><figcaption><span>dice.emblem</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'>ul.dice
</span><span class='line'>  each die in this.rolling
</span><span class='line'>    App.DieView
</span></code></pre></td></tr></table></div></figure>


<p>Using this code, the parent template <code>dice.emblem</code> passes the <code>die</code> variable to the <code>DieView</code>, where its child template, <code>die.emblem</code> renders <code>die</code> data.</p>

<h2>Pass Data Into Ember View</h2>

<p>To pass the <code>die</code> data from <code>dice.emblem</code> into the <code>DieView</code> to be used programatically, however, you need an extra attribute.  Change <code>dice.emblem</code>, adding <code>contentBinding</code>:</p>

<figure class='code'><figcaption><span>dice.emblem</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'>ul.dice
</span><span class='line'>  each die in this.rolling
</span><span class='line'>    App.DieView contentBinding=&quot;die&quot;
</span></code></pre></td></tr></table></div></figure>


<p>Now you can access the <code>die</code> data via a special Ember View variable named <code>content</code>.  Why might you want to get to this data programatically in the view code?&#8230;</p>

<h2>Passing Data from Ember View to Controller</h2>

<p>You might want to pass it somewhere else.  Remember, Ember Views are meant to take primitive UI events and translate them into semantic events, meaningful to your application.  For example, our view might want to translate a die element <code>click</code> on the DOM into a <code>roll</code> event in the application.  We made the modification to <code>dice.emblem</code> to pass the data in.  Now, let&#8217;s send it to the controller like this:</p>

<figure class='code'><figcaption><span>die-view.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">App.DieView = </span><span class="nx">Ember</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span>
</span><span class='line'>  <span class="nv">templateName: </span><span class="s">&#39;die&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nv">click: </span><span class="nf">(evt) -&gt;</span>
</span><span class='line'>    <span class="nx">@get</span><span class="p">(</span><span class="s">&#39;controller&#39;</span><span class="p">).</span><span class="nx">send</span> <span class="s">&#39;roll&#39;</span><span class="p">,</span> <span class="nx">@get</span> <span class="s">&#39;content&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We retrieve the <code>content</code> variable (holding the <code>die</code>), and send it to the controller in scope as a roll event.  The controller now must implement a <code>roll</code> function.  Let&#8217;s say we have a game controller.  That code might look like this:</p>

<figure class='code'><figcaption><span>game-ctrl.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">App.GameController = </span><span class="nx">Ember</span><span class="p">.</span><span class="nx">ObjectController</span><span class="p">.</span><span class="nx">extend</span>
</span><span class='line'>
</span><span class='line'>  <span class="nv">roll: </span><span class="nf">(die) -&gt;</span>
</span><span class='line'>    <span class="c1"># roll die and advance game accordingly</span>
</span></code></pre></td></tr></table></div></figure>


<p>If the controller doesn&#8217;t implement this function, the current Ember Route may implement it in its <code>events</code> object.  If neither the controller or the route implement it, an exception is thrown.</p>

<p>In this way, Ember Views show their worth in collecting events and translating them to meaningful verbs that we can act upon in our application.  They become reusable, allowing us to bind different content to them on different occassions.  Do Ember Views help you in this way?  Is there a better way?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[When to Use Curlies in Angular Directives]]></title>
    <link href="http://jaketrent.com/post/when-to-use-curlies-in-angular-directives/"/>
    <updated>2013-06-24T17:03:00-06:00</updated>
    <id>http://jaketrent.com/post/when-to-use-curlies-in-angular-directives</id>
    <content type="html"><![CDATA[<p>Angularjs has some sweet built-in directives.  Sometimes it can be confusing when to use the curly braces around expressions in directive attributes and when not to.  Here are a couple rules.</p>

<p><img src="http://i.imgur.com/wVBKD.png" alt="Angular directive curlies" /></p>

<!--more-->


<h2>Curlies</h2>

<p>By &#8220;curlies&#8221;, I mean curly braces.  The difference of when to use or not use them looks like the following.</p>

<p>Use them:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;element</span> <span class="na">ng-attribute=</span><span class="s">&quot;{{valWithCurlies}}&quot;</span> <span class="nt">/&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Or despise them:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;element</span> <span class="na">ng-attribute=</span><span class="s">&quot;valWithNone&quot;</span> <span class="nt">/&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Two Rules of Thumb</h2>

<p>Here are two rules that will serve you well when deciding whether or not to use curlies.</p>

<ol>
<li>Assume no curlies in Angular directive attribute values.  Most directives don&#8217;t use them.</li>
<li>If you would conceivably want to mix strings with Javascript code in the attribute, use curlies.</li>
</ol>


<h2>Two Examples with Curlies</h2>

<p>There are only a few examples of directives using curlies in their attributes.  These examples are both relating to pathing.  Apparently that&#8217;s a common use case for mixing strings with JavaScript-borne values.</p>

<h3>ngSrc</h3>

<p>As in the source of an image, such as:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;img</span> <span class="na">ng-src=</span><span class="s">&quot;/images/{{tool.icon_name}}.png&quot;</span> <span class="nt">/&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>ngHref</h3>

<p>As in a link to an html page, such as:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;a</span> <span class="na">ng-href=</span><span class="s">&quot;http://google.com?q={{query}}&quot;</span><span class="nt">&gt;</span>See Google Results<span class="nt">&lt;/a&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Something more Precise?</h2>

<p>Is there something more precise than these two rules of thumb?  Why does Angular make an exception for these two cases, thus causing us to try to remember our rules of thumb?</p>

<p>As I surmised above, I can only guess that because the pathing use case often wants to mix strings with JavaScript values, the exception was made.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Remove Mobile Safari Click Delay]]></title>
    <link href="http://jaketrent.com/post/remove-mobile-safari-click-delay/"/>
    <updated>2013-06-24T08:04:00-06:00</updated>
    <id>http://jaketrent.com/post/remove-mobile-safari-click-delay</id>
    <content type="html"><![CDATA[<p>Did you know that Mobile Safari and other mobile browsers are delaying your click events?  If you&#8217;ve been testing your mobile site, and it feels sluggish in Mobile Safari, this could be one of the reasons.  Disable the click delay and rejoice at a bit more snappy response.</p>

<p><img src="http://i.imgur.com/PH8Zosr.png" alt="mobile browser delay" /></p>

<!--more-->


<h2>Sandbagging?</h2>

<p>Why would a browser vendor build in this &#8220;functionality&#8221;?  Are they purposefully sandbagging their web experience so consumers will be more drawn to a device-specific app instead?  As if that could ever happen.</p>

<p>Google, as with most things, has an answer.  From a <a href="https://developers.google.com/mobile/articles/fast_buttons?hl=de-DE.">Google Developer article</a>:</p>

<blockquote><p>The reason for [the 300ms delay] is that the browser is waiting to see if you are actually performing a double tap.</p></blockquote>

<p>As with the apps Google was developing, the buttons that we&#8217;re designing don&#8217;t really need this check for double taps.  We really just want fast buttons.</p>

<h2>FastClick</h2>

<p>Really, most of the work for this problem is figuring out where the slowness is coming from.  I spent days and days trying to optimize a single-page web app that had a bunch of buttons with click events that seemed slow for some reason.  I came up with all sorts of theories and wasted a lot of time.</p>

<p>Now that you know what your problem is, just download and use a library to solve it.  Of the most fantastic, <a href="https://github.com/ftlabs/fastclick">FastClick</a>.  It&#8217;s easy to use.</p>

<p><strong>Step 1</strong>
Include the script in the <code>head</code> tag:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;fastclick.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Step 2</strong>
Attach FastClick to all links on the page (or subset if you wish):</p>

<figure class='code'><figcaption><span>a-whole-new-world.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span> <span class="s">&#39;load&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
</span><span class='line'>  <span class="nx">FastClick</span><span class="p">.</span><span class="nx">attach</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span>
</span><span class='line'><span class="p">,</span> <span class="kc">false</span>
</span></code></pre></td></tr></table></div></figure>


<p>Just like that, you&#8217;ll see marked improvements.  Thank you Apple.  Thank you FastClick.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ngStyle Background]]></title>
    <link href="http://jaketrent.com/post/ngstyle-background/"/>
    <updated>2013-06-19T07:08:00-06:00</updated>
    <id>http://jaketrent.com/post/ngstyle-background</id>
    <content type="html"><![CDATA[<p><code>ngStyle</code> is the directive used to set inline style attributes with AngularJs.  Most of the time, it&#8217;s straightforward to use.  <code>background</code> css attributes can be just slightly trickier.</p>

<p><img src="http://i.imgur.com/wVBKD.png" alt="AngularJs" /></p>

<!--more-->


<h2>ngStyle Objects</h2>

<p>The <code>ngStyle</code> directive requires an object for input.  The object key is the css attribute name.  The resultant value for the key is the value of the css attribute.</p>

<p><code>ngStyle</code> is obviously used to set dynamic styles, because static styles are more easily and efficient set using the standard html <code>style</code> attribute.</p>

<h2>A Dynamic Style Example</h2>

<p>So let&#8217;s setup a controller that sets a dynamic color based on something as useful as the time.  Useful, right?</p>

<figure class='code'><figcaption><span>colorCtrl.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s">&#39;colorly&#39;</span><span class="p">).</span><span class="nx">controller</span> <span class="s">&#39;colorCtrl&#39;</span><span class="p">,</span> <span class="nf">($scope) -&gt;</span>
</span><span class='line'>  <span class="nv">$scope.getColor = </span><span class="o">-&gt;</span>
</span><span class='line'>    <span class="k">if</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">is</span> <span class="mi">0</span> <span class="k">then</span> <span class="s">&quot;red&quot;</span> <span class="k">else</span> <span class="s">&quot;blue&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We could use this <code>getColor</code> function in our app:</p>

<figure class='code'><figcaption><span>app.jade</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'>html(ng-app=&quot;colorly&quot;)
</span><span class='line'>  head
</span><span class='line'>    <span class="c">//- ... include Angular, etc</span>
</span><span class='line'>  body(ng-controller=&quot;colorly&quot;)
</span><span class='line'>    p(ng-style=&quot;{ color: getColor() }&quot;)
</span><span class='line'>      | The text will be one of two colors
</span></code></pre></td></tr></table></div></figure>


<h2>A Background Example</h2>

<p>If we have a dynamic value that needs to go in a css <code>background</code> or <code>background-image</code> attribute, it can be just a bit more tricky to specify.</p>

<p>Let&#8217;s say we have a <code>getImage()</code> function in our controller.  This function returns a string formatted similar to this: <code>url(icons/pen.png)</code>.  If we do, the <code>ngStyle</code> declaration is specified the exact same way as before:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'>ng-style=&quot;{ &#39;background-image&#39;: getImage() }&quot;
</span></code></pre></td></tr></table></div></figure>


<p>Make sure to put quotes around the <code>background-image</code> key name.  Remember, this must be formatted as a valid Javascript object key.</p>

<h2>Another Background Example</h2>

<p>That example was easy.  Often, however, you don&#8217;t have data stored in your models that&#8217;s formatted like <code>url(icons/pen.png)</code>.  Instead you often have a field that represents the image path only.  In this case, you must do some JavaScript inside your <code>ngStyle</code> declaration:</p>

<figure class='code'><figcaption><span>colorCtrl.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s">&#39;colorly&#39;</span><span class="p">).</span><span class="nx">controller</span> <span class="s">&#39;colorCtrl&#39;</span><span class="p">,</span> <span class="nf">($scope) -&gt;</span>
</span><span class='line'>  <span class="nv">$scope.tool =</span>
</span><span class='line'>    <span class="nv">name: </span><span class="s">&#39;Pen&#39;</span>
</span><span class='line'>    <span class="nv">icon: </span><span class="s">&#39;icons/pen.png&#39;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'>ng-style=&quot;{ &#39;background-image&#39;: &#39;url(&#39; + tool.icon + &#39;)&#39; }&quot;
</span></code></pre></td></tr></table></div></figure>


<p>Remember that it&#8217;s just Javascript, and you&#8217;ll setup the string concatenation to work just fine.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mongoose Population]]></title>
    <link href="http://jaketrent.com/post/mongoose-population/"/>
    <updated>2013-06-18T07:39:00-06:00</updated>
    <id>http://jaketrent.com/post/mongoose-population</id>
    <content type="html"><![CDATA[<p><a href="http://mongoosejs.com">Mongoose</a> is an object modeler for <a href="http://mongodb.org">MongoDb</a>.  It has a particularly great feature, called <a href="http://mongoosejs.com/docs/populate.html">population</a>.  Population allows you to include other objects in a specified object.  It makes the process a lot easier and more automatic.</p>

<p><img src="http://i.imgur.com/pezEyw7.jpg" alt="Mongoose" /></p>

<!--more-->


<h2>Document Design</h2>

<p>Document databases provide a lot of flexibility in how data is modeled.  Just as the name suggests, data will often mimic real-world documents.  MongoDb isn&#8217;t a document database per se, but it has enough flexibility to be treated as one.  Mongoose population can help.</p>

<p>A document is often optimized for reads.  All the data is included, such as it would be on a real-world piece of paper.</p>

<p>In Mongo, data is divided into collections.  Mongoose helps define discrete schemas for data in each.  This separates and makes data fields explicit.  This helps with data organization, storage, and writing.  Population helps bring data from different collections back together again easily.  From the <a href="http://mongoosejs.com/docs/populate.html">docs</a>:</p>

<blockquote><p>Population is the process of automatically replacing the specified paths in the document with document(s) from other collection(s).</p></blockquote>

<p>So, let&#8217;s try it out with a couple examples.</p>

<h2>Data Definition</h2>

<p>Mongo will add a primary surrogate key to each object, called <a href="http://docs.mongodb.org/manual/reference/object-id/">ObjectId</a>, referenced as <code>_id</code> in the data.  This will be the key used to refer to objects in other collections.  If I wanted to model players in leagues &#8211; foosball leagues of course &#8211;  I might create schemas like this:</p>

<figure class='code'><figcaption><span>player.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">mongoose = </span><span class="nx">require</span> <span class="s">&#39;mongoose&#39;</span>
</span><span class='line'><span class="nv">Schema = </span><span class="nx">mongoose</span><span class="p">.</span><span class="nx">Schema</span>
</span><span class='line'>
</span><span class='line'><span class="nv">playerSchema = </span><span class="k">new</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">Schema</span>
</span><span class='line'>  <span class="nv">display_name: </span><span class="nb">String</span>
</span><span class='line'>  <span class="nv">leagues: </span><span class="p">[</span>
</span><span class='line'>    <span class="nv">type: </span><span class="nx">Schema</span><span class="p">.</span><span class="nx">Types</span><span class="p">.</span><span class="nx">ObjectId</span>
</span><span class='line'>    <span class="nv">ref: </span><span class="s">&#39;League&#39;</span>
</span><span class='line'>  <span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="nv">Player = </span><span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span> <span class="s">&#39;Player&#39;</span><span class="p">,</span> <span class="nx">playerSchema</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>league.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">mongoose = </span><span class="nx">require</span> <span class="s">&#39;mongoose&#39;</span>
</span><span class='line'><span class="nv">Schema = </span><span class="nx">mongoose</span><span class="p">.</span><span class="nx">Schema</span>
</span><span class='line'>
</span><span class='line'><span class="nv">leagueSchema = </span><span class="k">new</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">Schema</span>
</span><span class='line'>  <span class="nv">display_name: </span><span class="nb">String</span>
</span><span class='line'>  <span class="nv">created_by:</span>
</span><span class='line'>    <span class="nv">type: </span><span class="nx">Schema</span><span class="p">.</span><span class="nx">Types</span><span class="p">.</span><span class="nx">ObjectId</span>
</span><span class='line'>    <span class="nv">ref: </span><span class="s">&#39;Player&#39;</span>
</span><span class='line'>  <span class="nv">players: </span><span class="p">[</span>
</span><span class='line'>    <span class="nv">type: </span><span class="nx">Schema</span><span class="p">.</span><span class="nx">Types</span><span class="p">.</span><span class="nx">ObjectId</span>
</span><span class='line'>    <span class="nv">ref: </span><span class="s">&#39;Player&#39;</span>
</span><span class='line'>  <span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="nv">League = </span><span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span> <span class="s">&#39;League&#39;</span><span class="p">,</span> <span class="nx">leagueSchema</span>
</span></code></pre></td></tr></table></div></figure>


<p>A few points of interest:</p>

<ul>
<li>Since we are using <code>_id</code> to refer to other objects, we use the <code>ObjectId</code> type in the Mongoose definition.  You can use other fields.  Just make sure the type matches.</li>
<li>The <code>ref</code> attribute must match <em>exactly</em> the model name in your model definition.  Otherwise you&#8217;ll get something like this little beauty: <code>MissingSchemaError: Schema hasn't been registered for model "Player".</code>.</li>
<li>Note that <code>League.players</code> is an array.  Just surround the field definition in square brackets to get this functionality.</li>
</ul>


<h2>Data Read</h2>

<p>Reading data is where Mongoose population really shines.  This is the magic that makes reads of documents very straightforward, easy, and fast.  The magic is in the <code>populate()</code> function.</p>

<h3>Populate One Field</h3>

<p>If I want to populate a single field in the query for an object, I specify the name of that field in a string to the <code>populate</code> function:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">Player</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="nv">_id: </span><span class="s">&#39;abc123&#39;</span> <span class="p">})</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">populate</span><span class="p">(</span><span class="s">&#39;leagues&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">exec</span> <span class="nf">(err, player) -&gt;</span> <span class="c1">#...</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>leagues</code> will be populated with an array of full <code>League</code> objects when the resulting json returned, just like magic.</p>

<h3>Populate Multiple Fields</h3>

<p>Populating multiple referenced objects is similarly easy:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">League</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">find</span><span class="p">()</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">populate</span><span class="p">(</span><span class="s">&#39;created_by players&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">exec</span> <span class="nf">(err, league) -&gt;</span> <span class="c1">#...</span>
</span></code></pre></td></tr></table></div></figure>


<p>Just separate the field names in your <code>populate</code> parameter with spaces.  This query will return an array of <code>League</code> with the <code>created_by</code> and <code>player</code> fields populated with the associated <code>Player</code> objects.</p>

<h3>Populate Partial Objects</h3>

<p>Populating objects like this can quickly bloat your payload size.  To limit included objects to only a subset of fields, you can specify exactly what parts you want populated.  For instance, if my client UI only needed to show a list of leagues that a player belongs to, I could ask for just the <code>display_name</code> of the included <code>League</code> object by using a 2nd parameter:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">Player</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="nv">_id: </span><span class="s">&#39;abc123&#39;</span> <span class="p">})</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">populate</span><span class="p">(</span><span class="s">&#39;leagues&#39;</span><span class="p">,</span> <span class="s">&#39;display_name&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">exec</span> <span class="nf">(err, player) -&gt;</span> <span class="c1">#...</span>
</span></code></pre></td></tr></table></div></figure>


<p>For listing multiple parts, separate the attribute names with spaces.</p>

<h3>Forget to Populate</h3>

<p>You might get so used to having objects populated for some of your queries that you might wonder why they&#8217;re not populated in your latest query.  You probably just forgot to call <code>populate()</code> in your query.  You must do this explicitly to get the inclusions you desire.  Otherwise, you the data you query will just include the <code>_id</code> values.</p>

<h3>Explicitly Exclude Field</h3>

<p>It might not be that you forgot to populate, but that on some queries you don&#8217;t want to populate.  In these cases, you might not want to be sending around unneeded <code>_id</code> values, especially if they make up a large portion of your data size.  You can explicitly exclude such fields.  For instance, if you wanted all <code>Player</code> models but weren&#8217;t going to populate <code>leagues</code>, you might query:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">Player</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">find</span><span class="p">()</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s">&#39;-leagues&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">exect</span> <span class="nf">(err, players) -&gt;</span> <span class="c1">#...</span>
</span></code></pre></td></tr></table></div></figure>


<p>Note the <code>-</code> sign in the <code>select</code> clause.  This removes the field from the results.</p>

<h2>Data Write</h2>

<p>When you go to read the data, it&#8217;s quick, easy, and automatic.  But that&#8217;s because some work was done previously to reference the correct objects and make sure these references are saved.  Therefore, the naturally more work-intensive part of the population story is the data writing.</p>

<p>When we write to our example models, we need to save the proper references.  For instance, when a new <code>League</code> is created, let&#8217;s say it automatically needs a <code>created_by</code> <code>Player</code> reference saved and the creating <code>Player</code> will automatically join the league:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">league =</span>
</span><span class='line'>  <span class="nv">display_name: </span><span class="nx">myLeagueName</span>
</span><span class='line'>  <span class="nv">created_by: </span><span class="nx">currentPlayer</span><span class="p">.</span><span class="nx">_id</span>
</span><span class='line'>
</span><span class='line'><span class="nx">League</span><span class="p">.</span><span class="nx">create</span> <span class="nx">league</span><span class="p">,</span> <span class="nf">(err, league) -&gt;</span>
</span><span class='line'>  <span class="k">if</span> <span class="nx">err</span><span class="o">?</span>
</span><span class='line'>    <span class="c1"># ... do smart things that are never shown in a tutorial</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">Player</span><span class="p">.</span><span class="nx">update</span> <span class="p">{</span> <span class="nv">_id: </span><span class="nx">currentPlayer</span><span class="p">.</span><span class="nx">_id</span> <span class="p">},</span>
</span><span class='line'>      <span class="nv">$push:</span>
</span><span class='line'>        <span class="nv">leagues: </span><span class="nx">league</span><span class="p">.</span><span class="nx">_id</span>
</span><span class='line'>    <span class="p">,</span> <span class="nf">(err, numberAffected, raw) -&gt;</span>
</span><span class='line'>      <span class="k">if</span> <span class="nx">err</span><span class="o">?</span>
</span><span class='line'>        <span class="c1"># you know...</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>        <span class="nx">res</span><span class="p">.</span><span class="nx">json</span> <span class="nx">league</span>
</span></code></pre></td></tr></table></div></figure>


<p>A few points of interest:</p>

<ul>
<li>Lowercase <code>league</code> is just the json to populate a <code>League</code> model.  <code>league</code> is also the shadowed variable name in the <code>League.create</code> callback.</li>
<li><code>currentPlayer</code> is just an imagined <code>Player</code> reference that has an <code>_id</code> that you will use to associate <code>Player</code> to this <code>League</code>.</li>
<li><a href="http://docs.mongodb.org/manual/reference/operator/push/"><code>$push</code></a> is a special <code>update</code> attribute that appends new elements to a model&#8217;s array.</li>
</ul>


<p>Depending on how complex your model relationships become, you may opt for a difference code strategy besides nesting callbacks.  Don&#8217;t like your pyramid of doom?  Try the awesome <a href="https://github.com/caolan/async">async.js</a>.</p>

<p>I don&#8217;t know if Mongoose population is going to change your life, but I was very happy when I found this feature.  I had been doing junk like this manually.  What are some other great use cases that you&#8217;ve found?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Learn to Procrastinate]]></title>
    <link href="http://jaketrent.com/post/learn-to-procrastinate/"/>
    <updated>2013-06-10T06:57:00-06:00</updated>
    <id>http://jaketrent.com/post/learn-to-procrastinate</id>
    <content type="html"><![CDATA[<p>When making software, sometimes we want everything we can imagine at once.  We want the software to be perfect &#8211; then we&#8217;ll ship it.  Learn to procrastintate.  You might ship more, and you might like the the eventual outcome better.</p>

<p><img src="http://i.imgur.com/cXx17co.png" alt="Focus on shipping" /></p>

<!--more-->


<h2>Worthless Software</h2>

<p>Software that sits inside of your git repo, unreleased, is worthless software.  You&#8217;re not going to get paid for it.  You&#8217;re not going to make someone&#8217;s life better.  You&#8217;re not going to attract any new business.  It provides no utility.</p>

<p>When does software return any value?  At the very soonest, software provides value when it ships &#8211; when it&#8217;s released to the public or your customers.</p>

<p>So why do we wait so long to ship?</p>

<h2>Excuses for Not Shipping</h2>

<h3>It Must Do More</h3>

<p>Software has a fair bit of built-in or essential complexity.  Making software is challenging.  Sometimes we make it worse and introduce our own accidental complexity.  How?  We don&#8217;t ship.</p>

<p>We iterate on unreleased software, expand it, and pretend to fully understand what we&#8217;re trying to solve.  The software gets bigger and more complex.  We want our (unshipped) software to somehow solve even <em>more</em> problems before it&#8217;s solved any.  And any problem we attempt to solve without actually testing it (in production), is still just a guess at how to solve it.</p>

<h3>It&#8217;s Not Awesome Yet</h3>

<p>Sometimes in an attempt to create a (hopefully) great initial impression, we wait to release anything.  This makes sense to some degree, but it can easily be taken to a less useful extreme.  Once we have a feature set that we judge is sufficiently awesome to blow a potential client&#8217;s socks off, we&#8217;ll release it in a big bang.  Boom!  Now the world can see my software in all the glory I have bequeathed it.</p>

<p>Just as we have been guessing as to how may problems the software will solve, we have been guessing as to how warm people will be to the idea of actually using what we&#8217;ve created.</p>

<h2>What to Procrastinate</h2>

<p>So obviously there are problems with procrastinating.  There are definitely things that you <em>don&#8217;t</em> want to procrastintate: working, shipping, asking for payment.  What <em>should</em> you procrastinate?</p>

<h3>Little Things that are Hard</h3>

<p>At first glance, this just looks like a cop out.  You <em>should</em> do the important things that are hard.  Even the small things can add a nice touch.  But in an effort to ship, these are often the little things that don&#8217;t add too much but take an inordinate amount of time to figure out or complete.  Skip these things and come back to them later to add the polish.</p>

<h3>Things that are not Core Functionality</h3>

<p>You&#8217;re trying to ship a small, cohesive feature set as fast as you can.  There will be many features on the perephery that you&#8217;ll be tempted to work in as well.  Fight the temptation.  Get used to cutting out good features in order to ship the ones you <em>need</em>.  In this way, you&#8217;ll help ensure that all of your valuable time is used creating the most value for your customers.</p>

<h3>Things that Create Little Tech Debt</h3>

<p>When you start skipping things, this can create problems for you later.  This can be technical debt.  If you want your product to evolve and grow over time, you can&#8217;t afford large amounts of technical debt.  But watch out!  You can use very large lengths of time doing things that add little value in the name of avoiding technical debt.  Be willing to take on some tech debt.  Do this on a case-by-case basis, because this trade-off requires thinking.</p>

<h2>Why You&#8217;ll Like Procrastinating</h2>

<p>Your satisfaction will sky-rocket when you feel like shipping is within reach.  Break down the barriers to getting there.</p>

<p>Focus on the most valuable features, and you&#8217;ll feel like you add maximum value every day &#8211; because you are!</p>

<p>You&#8217;ll be able to move faster because you aren&#8217;t getting bogged down in munitia.  By not taking tangents, your flow time will increase.  You won&#8217;t need to context switch to solve small, hard problems.  You can focus on the important, hard problems for contiguous lengths of time.</p>

<p>You&#8217;ll have something to show a lot faster.  You&#8217;ll have a vertical of working features that are fun to use and are useful &#8211; when shipped, that is.</p>

<h2>Different Paths Converge at Shipping</h2>

<p>Of course there are as many different ways to make software as there are types of software and types of software teams.  That&#8217;s one of the things that makes software creation insanely fun and rewarding.  Find what works for you, and ship lots and lots of awesome software.</p>

<p>In the end, shipping should be a common goal, and we shouldn&#8217;t procrastinate that.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CSS Vertical Height of Text]]></title>
    <link href="http://jaketrent.com/post/css-text-vertical-height/"/>
    <updated>2013-06-03T07:36:00-06:00</updated>
    <id>http://jaketrent.com/post/css-text-vertical-height</id>
    <content type="html"><![CDATA[<p>Setting text elements on a page to be a specific height is usually straight forward.  Here are the specs for a couple textual situations you&#8217;ll encounter.</p>

<p><img src="http://i.imgur.com/hxw13Yp.png" alt="CSS height" /></p>

<!--more-->


<p><strong>Note:</strong> Experiments were done in Chrome 27, but this should be pretty consistent over browsers</p>

<h2>Text in a Div</h2>

<p>Text is likely most common just plastered across your site.  Lucky for us all, this is the most straightforward way to calculate and guarantee a vertical height.</p>

<p><img src="http://i.imgur.com/cy3HTWW.png" alt="Text height css" /></p>

<p>The formula is simple.  Here, vertical height is calculated by:</p>

<blockquote><p>vertical height = margin + border + padding + (line-height || height)</p></blockquote>

<p><code>line-height</code> or <code>height</code> will determine the height of the main body of the text container, such as a <code>div</code>.  Either one will do.</p>

<p>I will guess that most of the time you&#8217;ll want your text centered vertically in the container.  But for those times you want it hugging the top or bottom, add a line-height that&#8217;s either smaller or larger than the height, respectively, to move the text vertically within the container.</p>

<h2>Text in an Input</h2>

<p>Text appearing within an input field is much more tricky and has a quite a few more caveats.  There are two main different modes that vertical height will be determined by: without a <code>height</code> or with a <code>height</code> specified:</p>

<p><img src="http://i.imgur.com/4UdHhF4.png" alt="Input height css" /></p>

<h3>No Height Specified</h3>

<p>If the <code>height</code> is not set, traditional attributes, combined, create the total vertical height.  This formula becomes:</p>

<blockquote><p>height = margin + border + padding + (line-height || font-size)</p></blockquote>

<p>Some observations and caveats:</p>

<ul>
<li><code>font-size</code> only affects vertical height as it approaches or exceeds the <code>line-height</code>.</li>
<li><code>padding</code>, <code>border</code>, and <code>margin</code> always affect the vertical height, no matter their value.</li>
<li>If <code>font-size</code> is small enough to not affect <code>line-height</code>, <code>line-height</code> can be used for an exact vertical height sum.</li>
<li>If <code>font-size</code>, instead of <code>line-height</code> is affecting the vertical height, the px value of the <code>font-size</code> will not be usable to guarantee height.  Each font has different heights.  A per-font calculation will have to be made.</li>
</ul>


<h3>Height Specified</h3>

<p>If <code>height</code> is set, the input&#8217;s vertical height formula will always</p>

<blockquote><p>vertical height = height + margin</p></blockquote>

<p>Some observations and caveats:</p>

<ul>
<li>If <code>margin</code>, <code>border</code>, and <code>padding</code> add up to be greater than <code>height</code>, then that becomes new height.</li>
<li><code>line-height</code> and <code>font-size</code> don&#8217;t contribute the vertical height, no matter the <code>height</code> attribute.</li>
<li><code>margin</code>, <code>border</code>, and <code>padding</code> attributes don&#8217;t contribute at all to the vertical height if their sum height is less than the actual <code>height</code> attribute.</li>
<li>Once <code>line-height</code> exceeds <code>height</code>, the text in the input moves vertically downward, eventually becoming hidden.</li>
<li>As <code>font-size</code> approaches <code>height</code>, the text will eventually become hidden.</li>
<li><code>border</code> will not affect vertical height, but it will still affect horizontal width.</li>
<li><code>vertical-align</code>, as in most things, does nothing.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ember Parent Templates]]></title>
    <link href="http://jaketrent.com/post/ember-parent-templates/"/>
    <updated>2013-05-29T07:02:00-06:00</updated>
    <id>http://jaketrent.com/post/ember-parent-templates</id>
    <content type="html"><![CDATA[<p><a href="http://emberjs.com">Ember</a>&#8217;s convention of template hierarchy is very specific.  Learn it once, and you&#8217;ll know it every time.</p>

<p><img src="http://i.imgur.com/x5HT4FN.jpg" alt="Ember and Handlebars" /></p>

<!--more-->


<p><strong>Note:</strong> Code examples use <a href="http://emblemjs.com/">Emblem</a> templates and <a href="http://coffeescript.org">CoffeeScript</a>.  Vanilla Handlebars and JavaScript would work just as well.</p>

<h2>Outlets</h2>

<p>Ember templates make use of a special helper called <code>outlet</code>.  You can have one main, unnamed outlet or many named outlets.  The main thing to remember is that a child template will always render inside its parent&#8217;s outlet &#8211; so always put outlets in templates that have children.</p>

<h2>Application Template</h2>

<p>There is a top-most template that all of your templates will render inside of.  This is called the application template.  It is specified in one of two ways.  If you are including your templates as script tags, simply create a script tag that doesn&#8217;t have a <code>data-template-name</code> or <code>id</code> attribute, a la:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;x-emblem&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nx">h1</span> <span class="nx">My</span> <span class="nx">Application</span>
</span><span class='line'>  <span class="o">==</span> <span class="nx">outlet</span>
</span><span class='line'><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you are <a href="http://jaketrent.com/post/precompile-ember-templates">precompiling your Ember templates</a>, which you should, you have a directory for templates.  You will put your file, called <code>application.emblem</code> in the root of that directory.  The contents of <code>templates/application.emblem</code> would be the same:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='jade'><span class='line'><span class="nt">h1</span> My Application
</span><span class='line'><span class="err">== </span><span class="nt">outlet</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Route Templates</h2>

<p>If you have a top-level route, it will have a top-level template.  Your route&#8217;s template will have only the application template as its parent.  So, your about route:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">App</span><span class="p">.</span><span class="nx">Router</span><span class="p">.</span><span class="nx">map</span> <span class="o">-&gt;</span>
</span><span class='line'>  <span class="nx">@route</span> <span class="s">&#39;about&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Will have an about template at <code>templates/about.emblem</code> and you could define a route as <code>AboutRoute</code>.  It will render inside of <code>application.emblem</code>&#8217;s outlet.</p>

<h2>Resource Templates</h2>

<p>Resources are interesting because you can nest other routes inside them.  Nesting routes will also result in nesting templates.  If I defined a <code>league</code> resource with a nested route for creating new leagues, it might look something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">App</span><span class="p">.</span><span class="nx">Router</span><span class="p">.</span><span class="nx">map</span> <span class="o">-&gt;</span>
</span><span class='line'>  <span class="nx">@resouce</span> <span class="s">&#39;league&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
</span><span class='line'>    <span class="nx">@route</span> <span class="s">&#39;new&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>There are two leaf routes (and thus templates) that are created here:</p>

<ul>
<li><code>LeagueIndexRoute</code>, which uses <code>templates/league/index.emblem</code></li>
<li><code>LeagueNewRoute</code>, which uses <code>templates/league/new.emblem</code></li>
</ul>


<p>Note that you create a <code>league</code> directory inside your <code>templates</code> directory for nesting these templates.  Precompiled templates will be created at:</p>

<ul>
<li><code>Ember.TEMPLATES["league/index"]</code></li>
<li><code>Ember.TEMPLATES["league/new"]</code></li>
</ul>


<p>If you wanted to use the <code>linkTo</code> helper in a template to link to these routes, you would use this syntax:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='jade'><span class='line'><span class="nt">linkTo</span> &#39;league.index&#39; | List Leagues
</span><span class='line'><span class="nt">linkTo</span> &#39;league.new&#39; | New League
</span></code></pre></td></tr></table></div></figure>


<p>And now as far as templates, there is <em>one more</em> that we&#8217;re missing.  There is a root league template that these two league leaf templates render inside of.  It should live at <code>templates/league.emblem</code>.  This template would be useful for showing UI elements that are common to all league resource things.  In the case where there is no such need, this template will probably only contain a single outlet:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='jade'><span class='line'><span class="err">== </span><span class="nt">outlet</span>
</span></code></pre></td></tr></table></div></figure>


<p>So the final template hierarchy for <code>league.new</code>, for example, is <code>application.emblem &gt; league.emblem &gt; league/new.emblem</code>.</p>

<p>There is a bit of a chatter on the Githubs about whether the root resource template is good form or not.  As in, why would you create a file that contains nothing but an empty outlet?  Couldn&#8217;t the framework infer that if it was missing?</p>

<h2>Children Need All Parents</h2>

<p>Create all parents in your template chain, from the application template to the leaves.  The worst thing that can happen if you don&#8217;t is that nothing will render at all, and no error messages will be displayed (pretty bad and unhelpful).</p>

<p>Most of the time, Ember will try to be helpful and give you a console warning:</p>

<blockquote><p>WARNING: The immediate parent route (&#8216;a&#8217;) did not render into the main outlet and the default &#8216;into&#8217; option (&#8216;p&#8217;) may not be expected</p></blockquote>

<p>In other words: You&#8217;re trying to render a child template that either doesn&#8217;t have a parent template it needs or the parent template does not specify a main outlet.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Precompile Ember Templates]]></title>
    <link href="http://jaketrent.com/post/precompile-ember-templates/"/>
    <updated>2013-05-21T07:54:00-06:00</updated>
    <id>http://jaketrent.com/post/precompile-ember-templates</id>
    <content type="html"><![CDATA[<p><a href="http://emberjs.com">Ember</a> makes use of the wonderful <a href="http://handlebarsjs.com">Handlebars</a> templates.  These templates, in order to be performant, must be precompiled.  Based on the Ember docs, it&#8217;s not abundantly clear how this is to happen.  Here&#8217;s a solution that works well.</p>

<p><img src="http://i.imgur.com/x5HT4FN.jpg" alt="Ember and Handlebars" /></p>

<!--more-->


<h2>Ember Docs for Precompilation</h2>

<p>Every official Ember doc will put templates in a <code>script</code> tag with the <code>type="text/x-handlebars"</code>.  But this is never how you&#8217;d write any serious (-ly awesome) app in production.  <a href="http://emberjs.com/guides/templates/handlebars-basics/">The docs</a> say:</p>

<blockquote><p>&#8220;If you are using build tools to manage your application&#8217;s assets, most will know how to precompile Handlebars templates and make them available to Ember.js.&#8221;</p></blockquote>

<p>Which tools?  Why would I want to precompile?  How <em>are</em> they made available to Ember?  Read, Ember journeyman, read on&#8230;</p>

<h2>Grunt</h2>

<p>We&#8217;d love for this precompilation to happen previous to the running of your app.  Again, this is in hopes of increased performance.  <a href="http://gruntjs.com">Grunt</a> is a great little Nodejs-based tool for build-level tasks.</p>

<h2>Emblem</h2>

<p>Grunt comes with a variety of plugins.  We&#8217;re going to use one called <a href="https://github.com/wordofchristian/grunt-emblem/">grunt-emblem</a>.  <a href="http://emblemjs.com/">Emblem</a> is a fantastic templating syntax layered on top of Handlebars (still a dependency).  Its syntax looks very similar to Haml or Ruby Slim or Jade.  It may well be the most flexible of all of them, and it simplifies some Ember helper syntax very nicely.</p>

<h2>Versions Matching</h2>

<p>As I&#8217;ve said before, <a href="http://jaketrent.com/post/match-ember-handlebars-version/">matching Ember dependency version can be a pain</a>.  With precompilation, you have one more dependency to match.  Now not only do you care about the version of Handlebars that Ember uses at runtime, but you care about the version of Handlebars that is used to precompile your templates.  If the precompile Handlebars version doesn&#8217;t match the runtime Handlebars version, your app will die at runtime.  <code>grunt-emblem</code> helps immensely with this.</p>

<h2>grunt-emblem</h2>

<p>I haven&#8217;t found another Handlebars precompile plugin that helps as much as <code>grunt-emblem</code>.  It solves the precompile version problem by letting you utilize the actual runtime Handlebars as the precompile Handlebars script.</p>

<p>It is also nice in that it puts the precompiled templates into the collection that Ember expects to find templates in, namely <code>Ember.TEMPLATES</code>.  As you can find on the <a href="https://github.com/wordofchristian/grunt-emblem/"><code>grunt-emblem</code> Github page</a>, your grunt config will look something like the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">matchdep = </span><span class="nx">require</span> <span class="s">&#39;matchdep&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">module.exports = </span><span class="nf">(grunt) -&gt;</span>
</span><span class='line'>  <span class="nx">grunt</span><span class="p">.</span><span class="nx">initConfig</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">watch:</span>
</span><span class='line'>      <span class="nv">ember_templates:</span>
</span><span class='line'>        <span class="nv">files: </span><span class="p">[</span><span class="s">&#39;app/views/templates/**/*.emblem&#39;</span><span class="p">]</span>
</span><span class='line'>        <span class="nv">tasks: </span><span class="p">[</span><span class="s">&#39;emblem&#39;</span><span class="p">,</span> <span class="s">&#39;livereload&#39;</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">emblem:</span>
</span><span class='line'>      <span class="nv">compile:</span>
</span><span class='line'>        <span class="nv">files:</span>
</span><span class='line'>          <span class="s">&quot;app/static/templates/ember_templates.js&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s">&quot;app/views/templates/**/*.emblem&quot;</span><span class="p">]</span>
</span><span class='line'>        <span class="nv">options:</span>
</span><span class='line'>          <span class="nv">root: </span><span class="s">&quot;app/views/templates/&quot;</span>
</span><span class='line'>          <span class="nv">dependencies:</span>
</span><span class='line'>            <span class="nv">jquery: </span><span class="s">&quot;app/static/js/components/jquery/jquery.js&quot;</span>
</span><span class='line'>            <span class="nv">ember: </span><span class="s">&quot;app/static/js/components/ember/ember.js&quot;</span>
</span><span class='line'>            <span class="nv">emblem: </span><span class="s">&quot;app/static/js/components/emblem/dist/emblem.js&quot;</span>
</span><span class='line'>            <span class="nv">handlebars: </span><span class="s">&quot;app/static/js/components/handlebars/handlebars.js&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">matchdep</span><span class="p">.</span><span class="nx">filterDev</span><span class="p">(</span><span class="s">&#39;grunt-*&#39;</span><span class="p">).</span><span class="nx">forEach</span> <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">grunt</span><span class="p">.</span><span class="nx">renameTask</span> <span class="s">&#39;regarde&#39;</span><span class="p">,</span> <span class="s">&#39;watch&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span> <span class="s">&#39;dev&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="s">&#39;livereload-start&#39;</span><span class="p">,</span> <span class="s">&#39;watch&#39;</span> <span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>This particular config has a couple other niceties.  Let me enumerate the awesome:</p>

<ul>
<li>Line 6 - Not only can we precompile the templates, but we&#8217;ll precompile on the fly, whenever <code>.emblem</code> files are change in the specified directories.</li>
<li>Line 8 and 14 - We&#8217;re precompiling <code>.emblem</code> templates, but this plugin can do regular Handlebars syntax as well</li>
<li>Line 16 - <code>root</code> is the substring that will be stripped out of your template name.  For instance, you don&#8217;t want your template to be called <code>app/views/templates/home</code>.  Your home route in Ember will want your template called <code>home</code>.  <code>root</code> to the rescue &#8211; bam!</li>
<li>Line 17 - These <code>dependencies</code> are the libraries that you use at runtime and that Handlebars needs at compile time.  As I said, this plugin simply rocks because of the ability to specify your own Handlebars script.</li>
<li>Line 23 - Remember how you used to have a whole list of npm tasks registered.  This little beaut will load all <code>grunt-*</code> dependencies.</li>
<li>Line 25 - <code>regarde</code> is a cool name, but I understand what <code>watch</code> means a bit better. Rename it.</li>
</ul>


<p>This setup requires the following dependencies:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">npm</span> <span class="nx">install</span> <span class="nx">matchdep</span> <span class="nx">grunt</span> <span class="nx">grunt</span><span class="o">-</span><span class="nx">regarde</span> <span class="nx">grunt</span><span class="o">-</span><span class="nx">contrib</span><span class="o">-</span><span class="nx">livereload</span> <span class="nx">grunt</span><span class="o">-</span><span class="nx">emblem</span> <span class="o">--</span><span class="nx">save</span><span class="o">-</span><span class="nx">dev</span>
</span></code></pre></td></tr></table></div></figure>


<p>So now, seriously, go write some Emblem templates.  So fun, so precompiled.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Match Ember and Handlebars Versions]]></title>
    <link href="http://jaketrent.com/post/match-ember-handlebars-version/"/>
    <updated>2013-05-21T07:38:00-06:00</updated>
    <id>http://jaketrent.com/post/match-ember-handlebars-version</id>
    <content type="html"><![CDATA[<p><a href="http://emberjs.com">Ember</a> is very specific about what version of <a href="http://handlebarsjs.com">Handlebars</a> it requires.  This is probably good, but it&#8217;s also a pain to work with as different versions of the two libraries are released independently.  There are a few good tools to help us out.</p>

<p><img src="http://i.imgur.com/x5HT4FN.jpg" alt="Ember and Handlebars" /></p>

<!--more-->


<h2>Released Independently</h2>

<p>In a prime example, recently there was a new version of Handlebars released: <code>1.0.0-rc.4</code>.  Ember happens to be on version <code>1.0.0-rc.3</code>.  That version has a hard dependency on Handlebars <code>1.0.0-rc.3</code>.  In other words, the latest Ember code relies on an older version of Handlebars.</p>

<h2>Bower</h2>

<p>If you include these 3rd party libraries in your source code under a <code>lib</code> directory or something of that nature, you <em>always</em> have plenty of work to do.  Naturally, you just copy in the exact versions of the scripts that are needed.</p>

<p>Hopefully you&#8217;re trying to make use of a mostly awesome tool, <a href="http://bower.io">Bower</a>.  It helps you manage these 3rd party libraries in a way similar to npm.  You provide a descriptor of your project&#8217;s dependencies, <code>component.json</code>.  And you install things similarly via the <code>bower</code> cli.</p>

<h2>Specify a Bower Version</h2>

<p>If I run:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>bower install handlebars --save</span></code></pre></td></tr></table></div></figure>


<p>It saves a dependency in my <code>components.json</code> for Handlebars for the latest version it could find.  This won&#8217;t do for us.  We need to specify the versions.</p>

<p>Our strategy will be: take the latest version of Ember and then specifically match the Handlbars version.  Finally, we should type:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>bower install ember --save
</span><span class='line'>bower install handlebars#1.0.0-rc.3</span></code></pre></td></tr></table></div></figure>


<p>As of this writing, that is the version of handlebars that is required.  Bower will recognize any semver git tag name or branch name after the hash <code>#</code> sign.</p>

<p>I like our version strategy for a project that is under active development in that it keeps us on the latest Ember.  But, if you&#8217;re on a project that&#8217;s been built to an Ember version and not deployed for a long time, you may want to make a very specific dependency out of Ember as well, so the two are guaranteed in sync for future deploys.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[UtahJS Conf 2013 Review]]></title>
    <link href="http://jaketrent.com/post/utahjs-conf-2013-review/"/>
    <updated>2013-05-20T06:59:00-06:00</updated>
    <id>http://jaketrent.com/post/utahjs-conf-2013-review</id>
    <content type="html"><![CDATA[<p><img src="http://i.imgur.com/G3BBShC.png" alt="UtahJS" /></p>

<!--more-->


<h2>The Schedule</h2>

<p>The conference covered a single day.  Keynote in the morning by Tom Dale, co-creator of Emberjs.  3 tracks thereafter with 5 talks each.  There was a specialized track, all focused on Angular, which was nice for anyone that wanted to focus on that framework.  There was less Node focus overall compared to last year, which was disappointing.  There were 3 talks focused on testing.  We need more good testing talks.</p>

<p>My impression on the talks overall was that they were well done and that the speakers were generally engaging.  The topics focused a little much on browser-side MV* frameworks, but I guess that&#8217;s hot right now.  Every talk I went to was meant for beginners at a very introductory level.  That was disappointing.  Of the topics presented, I found myself surprisingly most interested in Emberjs.  I have been tinkering with it since then and need to build something with it.</p>

<h2>The Food</h2>

<p>There was a plentitude of simple carbohydrates ready to serve to all learners at all times.  That was awesome.  Pastries appeared for breakfast, un-advertised.  They didn&#8217;t do a boxed lunch this year.  Some didn&#8217;t cry.  I almost did.  But I was pointed to a great gryo at a nearby Greek eatery instead.  Apparently the host venue, the Salt Lake City Public Library, didn&#8217;t approve of serving food.  This, I don&#8217;t understand, given that there was plenty of food floating around.  Apparenly pastries are ok, and sandwiches are not.</p>

<h2>The People</h2>

<p>Always a fun flavor to a conference, the attendees were great to mingle with.  The JavaScript community is a fun group to be with.  In Utah, we&#8217;re a fairly small, tight group.  It was fun to have Tom Dale show up.  It was even said by some that the Ember folks were &#8220;actually nice&#8221; as opposed to what was thought to be observed by some on Twitter.  Haha.  I smiled quite a bit when I heard that.</p>

<h2>The Afterparty</h2>

<p>The party was put on by O.C. Tanner and Domo.  O.C. Tanner is my current home base.  We were in charge of prepping the space.  It was like a classic text adventure trying to guide party-comers through the labyrinth of the O.C. Tanner building to the eventual pot of gold that was the party.</p>

<p>The food never stopped coming, even after my stomach had taken on its full capacity.  Marvelous Catering (gotta love that name) provided a delicious &#8220;luau pork dinner&#8221;.  I heard &#8220;luau&#8221; and assumed pineapple, of which there was none, which disappointed me just a little.  The owner of Fongo Bongo, a local game shop supplied a great collection of board and card games.  We had a couple Xboxen humming whilst TVs blasted fighting games to which I knew no combos.  We had a great time.</p>

<h2>Next Year</h2>

<p>I&#8217;m glad that this event has shown some perpetuity.  I hope it continues next year.  I think they have a good formula.  The price, the locale, the speaker lineup, and the associated activities make for a good one-day experience each Spring.  I would focus on improving one bit next year: the website.  It was the least well-done part of the conference.  I find that extremely ironic given the target market for the event.</p>

<p>So next Spring, come to Utah and attend the JsConf.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Test setTimeout with Jasmine]]></title>
    <link href="http://jaketrent.com/post/test-settimeout-with-jasmine/"/>
    <updated>2013-05-15T07:08:00-06:00</updated>
    <id>http://jaketrent.com/post/test-settimeout-with-jasmine</id>
    <content type="html"><![CDATA[<p>Code that utilizes <code>setTimeout</code> or <code>setInterval</code> becomes asynchronous.  Jasmine has some nice helpers to make your test synchronous again.</p>

<p><img src="http://i.imgur.com/Ks3wt01.jpg" alt="Jasmine" /></p>

<!--more-->


<h2>Code Using setTimeout</h2>

<p>Any Javascript code that wants to delay certain actions or give intervals between actions will use <code>setTimeout</code> or <code>setInterval</code> respectively.  There are also libraries that create some niceties for working in these situations, notably <a href="http://underscorejs.org">underscore</a>&#8217;s <code>_.throttle</code> and <code>_.debounce</code> functions.  Underneath all of these higher-level functions, they&#8217;re using the native <code>setTimeout</code> construct, so the same strategies will apply.  In your source, you end up with something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="kc">on</span> <span class="s">&#39;keyup&#39;</span><span class="p">,</span> <span class="s">&#39;.autocomplete-field&#39;</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">debounce</span><span class="p">(</span><span class="nx">autocomplete</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This code binds a keyup event listener on a contrived <code>.autocomplete-field</code>.  Of course, we don&#8217;t want to do an expensive <code>autocomplete</code> lookup on every keypress.  So, we&#8217;ll slow it down a bit with <code>_.debounce</code>.</p>

<h2>Testing Asynchronous Code in Jasmine</h2>

<p>Now we go to test it in Jasmine (failing):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'>  <span class="nx">describe</span> <span class="s">&#39;Autocomplete Field&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">it</span> <span class="s">&#39;calls autocomplete when typing&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
</span><span class='line'>      <span class="nv">called = </span><span class="kc">false</span>
</span><span class='line'>      <span class="nv">autocomplete = </span><span class="o">-&gt;</span>
</span><span class='line'>        <span class="nv">called = </span><span class="kc">true</span>
</span><span class='line'>
</span><span class='line'>      <span class="nv">keyup = </span><span class="nx">$</span><span class="p">.</span><span class="nx">Event</span><span class="p">(</span><span class="s">&#39;keyup&#39;</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="s">&#39;.autocomplete-field&#39;</span><span class="p">).</span><span class="nx">trigger</span> <span class="nx">keyup</span>
</span><span class='line'>      <span class="nx">called</span><span class="p">.</span><span class="nx">should</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="kc">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>In this test, or <code>autocomplete</code> spy will never be called, thus <code>called</code> will never be true.  There are a few ways to fix this.</p>

<h2>Mocking the Jasmine Clock</h2>

<p>One way to fix the test is to remove <code>_.debounce</code> from our source code.  That would make the test pass.  The other is to setup our Jasmine to handle the <code>setTimeout</code> used in <code>_.debounce</code>.  Let&#8217;s do the latter, and raise our fists to the sky in triumph over our testing foe (winning):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'>  <span class="nx">describe</span> <span class="s">&#39;Autocomplete Field&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">beforeEach</span> <span class="o">-&gt;</span>
</span><span class='line'>      <span class="nx">jasmine</span><span class="p">.</span><span class="nx">Clock</span><span class="p">.</span><span class="nx">useMock</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">it</span> <span class="s">&#39;calls autocomplete when typing&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
</span><span class='line'>      <span class="nv">called = </span><span class="kc">false</span>
</span><span class='line'>      <span class="nv">autocomplete = </span><span class="o">-&gt;</span>
</span><span class='line'>        <span class="nv">called = </span><span class="kc">true</span>
</span><span class='line'>
</span><span class='line'>      <span class="nv">keyup = </span><span class="nx">$</span><span class="p">.</span><span class="nx">Event</span><span class="p">(</span><span class="s">&#39;keyup&#39;</span><span class="p">)</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="s">&#39;.autocomplete-field&#39;</span><span class="p">).</span><span class="nx">trigger</span> <span class="nx">keyup</span>
</span><span class='line'>      <span class="nx">jasmine</span><span class="p">.</span><span class="nx">Clock</span><span class="p">.</span><span class="nx">tick</span> <span class="mi">501</span>
</span><span class='line'>      <span class="nx">called</span><span class="p">.</span><span class="nx">should</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="kc">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>The needed code is simple to add.  Use <code>jasmine.Clock.useMock()</code> to setup the fake ticker.  Then call <code>tick()</code> on it whenever you want your test to simulate time massage.</p>

<p>The cool thing is that this does not slow down your tests.  You could set the clock tick to be 50100000 or some crazy number, and it will still execute as fast as your single JavaScript thread will let you.</p>

<p>Boom.  Another testing hurdle cleared.  Sometimes it&#8217;s harder to write the test than the code.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LiveReload for NodeJs]]></title>
    <link href="http://jaketrent.com/post/livereload-for-nodejs/"/>
    <updated>2013-04-23T16:44:00-06:00</updated>
    <id>http://jaketrent.com/post/livereload-for-nodejs</id>
    <content type="html"><![CDATA[<p>LiveReload is a wonderful tool/strategy for being able to develop websites more quickly.  You can make a change and see it immediately shown in the browser without requiring you to manually refresh.  To do this in NodeJs with Express, you&#8217;ll need just a few packages.</p>

<p><img src="http://i.imgur.com/4773D.jpg" alt="grunt" /></p>

<!--more-->


<h2>LiveReload Express</h2>

<p>If you&#8217;re doing a website on Nodejs these days, you&#8217;re probably using Express.  Express uses the Connect library for its middleware scheme.  Just grab one more middleware to handle the LiveReload.  It will add a little snippet of JavaScript to each of the html responses that is requested through this middleware.  First, install:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm install connect-livereload --save-dev</span></code></pre></td></tr></table></div></figure>


<p>Next, import:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">configure</span> <span class="s">&#39;development&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
</span><span class='line'>  <span class="nx">app</span><span class="p">.</span><span class="nx">use</span> <span class="nx">require</span><span class="p">(</span><span class="s">&#39;connect-livereload&#39;</span><span class="p">)</span> <span class="mi">35729</span>
</span></code></pre></td></tr></table></div></figure>


<p>Note that we only want to import and use the middleware when in development.  This matches the fact that we are only declaring this package as in <code>devDependencies</code>.</p>

<h2>LiveReload Grunt</h2>

<p>Now you need to something to start a livereload server, watch files for changes, and broadcast their availability.  The rest of this will be done via Grunt.</p>

<p>First, install:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm install grunt-cli -g
</span><span class='line'>npm install grunt grunt-regarde grunt-contrib-livereload --save-dev</span></code></pre></td></tr></table></div></figure>


<ul>
<li><code>grunt-cli</code> will allow you to run the <code>grunt</code> command in the terminal.  Global puts the bin in your path.</li>
<li><code>grunt-regarde</code> is a file watcher.  It senses changes to the filesystem.</li>
<li><code>grunt-contrib-reload</code> will handle the pushing of new code to the browser.</li>
</ul>


<p>Next setup the <code>Gruntfile.coffee</code>:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">module.exports = </span><span class="nf">(grunt) -&gt;</span>
</span><span class='line'>  <span class="nx">grunt</span><span class="p">.</span><span class="nx">initConfig</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">regarde:</span>
</span><span class='line'>      <span class="nv">style:</span>
</span><span class='line'>        <span class="nv">files: </span><span class="p">[</span><span class="s">&#39;app/static/css/*.css&#39;</span><span class="p">]</span>
</span><span class='line'>        <span class="nv">tasks: </span><span class="p">[</span><span class="s">&#39;livereload&#39;</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span> <span class="s">&#39;grunt-contrib-livereload&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span> <span class="s">&#39;be-lively&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="s">&#39;livereload-start&#39;</span><span class="p">,</span> <span class="s">&#39;regarde&#39;</span> <span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now when you run:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>grunt be-lively</span></code></pre></td></tr></table></div></figure>


<p>A livereload server is going to be setup.  Then we watch for filesystem changes.  The only things we&#8217;re watching are css files in our app.  You could expand the <code>files</code> array to watch more if you wish.</p>

<p>Yay!</p>

<h2>LiveReload all the Things</h2>

<p>There are many ways to make this happen.  There are numerous Node libraries, Grunt plugins, and browser plugins.  Do what works for you.  Just make it happen fast and tend it well from the beginning to the end of your project.  Almost every solution I&#8217;ve found is somewhat high maintenance.  This one has proven to be the same.  What have you found to be your favorite LiveReload solution, and in what environment?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Access NodeJs App on Xip.io]]></title>
    <link href="http://jaketrent.com/post/nodejs-app-on-xipio/"/>
    <updated>2013-04-23T07:22:00-06:00</updated>
    <id>http://jaketrent.com/post/nodejs-app-on-xipio</id>
    <content type="html"><![CDATA[<p>Xip.io is a DNS wildcard domain that was initially created for use on Ruby projects.  But its application is desirable across platforms.  Recently, I wanted to use Xip.io on a NodeJs project.  It was easy to make happen.</p>

<p><img src="http://i.imgur.com/PJTnZmM.jpg" alt="xip.io" /></p>

<!--more-->


<h2>Update: Proxying is Built Into Pow</h2>

<p>After having a handful of problems with these home-grown proxies, my search eventually led me to know that Pow 0.4.0+ includes proxying as a built-in feature.  So, you don&#8217;t need your own <code>config.ru</code> any more.  Once you install pow, choose the port that your app will run on and at what pow address you want to access your app, and run one command in your terminal:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>echo 3000 &gt; ~/.pow/myapp</span></code></pre></td></tr></table></div></figure>


<p>Then you&#8217;ll access your app, running in the background on port 3000 via the web browser at <code>http://myapp.dev</code>.  Way better.  Skip the rest of this article.</p>

<h2>Install Pow and Powder</h2>

<p>Pow is a development server that uses Xip.io.  Powder is a cli that makes working with Pow even easier.  To start, make sure that <a href="http://www.ruby-lang.org/en/downloads/">Ruby</a> is setup with <a href="http://rubygems.org">Rubygems</a> in your environment.  Then install Pow.  They have a short little install script you can run, as <a href="http://pow.cx/">referenced on the Pow site</a>.</p>

<p>Then install Powder:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gem install powder</span></code></pre></td></tr></table></div></figure>


<h2>Proxy your NodeJs app</h2>

<p>Pow only knows how to handle Rack apps, so we have to create one to be loaded into Pow.  Since we&#8217;re writing the guts of our app on another platform &#8211; in this case, Node &#8211; we&#8217;ll just create a proxy Rack app.</p>

<p>I found a bit of <a href="https://github.com/linjunpop/node-with-pow">proxy app code</a>, which you should save in your project root as <code>config.ru</code>, and which I paste here:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s2">&quot;net/http&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">ProxyApp</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
</span><span class='line'>    <span class="k">begin</span>
</span><span class='line'>      <span class="n">request</span> <span class="o">=</span> <span class="no">Rack</span><span class="o">::</span><span class="no">Request</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
</span><span class='line'>      <span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>      <span class="n">env</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span>
</span><span class='line'>        <span class="k">if</span> <span class="n">key</span> <span class="o">=~</span> <span class="sr">/^http_(.*)/i</span>
</span><span class='line'>          <span class="n">headers</span><span class="o">[</span><span class="vg">$1</span><span class="o">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>      <span class="n">http</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
</span><span class='line'>      <span class="n">http</span><span class="o">.</span><span class="n">start</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
</span><span class='line'>        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">send_request</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">request_method</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">fullpath</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>
</span><span class='line'>        <span class="o">[</span><span class="n">response</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">to_hash</span><span class="p">,</span> <span class="o">[</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="o">]]</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">rescue</span> <span class="no">Errno</span><span class="o">::</span><span class="no">ECONNREFUSED</span>
</span><span class='line'>      <span class="o">[</span><span class="mi">500</span><span class="p">,</span> <span class="p">{},</span> <span class="o">[</span><span class="s2">&quot;Server is down, try $npm start&quot;</span><span class="o">]]</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="n">run</span> <span class="no">ProxyApp</span><span class="o">.</span><span class="n">new</span>
</span></code></pre></td></tr></table></div></figure>


<p>The only change you might have to make is the port number for your app (line 13).  In this case, I&#8217;m using port 3000 for my NodeJs app.</p>

<h2>Link Your App</h2>

<p>Now all we have to do is link our app to Pow.  Powder helps us do this easily.  Go to your project root directory and type:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>powder link &lt;project_name&gt;</span></code></pre></td></tr></table></div></figure>


<p>Now run your app with whatever command starts NodeJs.  It&#8217;s probably something like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>node app.js</span></code></pre></td></tr></table></div></figure>


<p>Now you should be able to access your app via your web browser at <code>http://&lt;project_name&gt;.dev</code>.  One of the great things about Xip.io is that it makes running your local app <a href="http://jaketrent.com/post/run-pow-server-on-vm/">extremely easy from a local Virtual machine</a> as well.  To get the address of your app to use in your VM, type this from your native terminal:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>powder open --xip</span></code></pre></td></tr></table></div></figure>


<p>And copy the resulting URL into your VM web browser.</p>

<p>Ah, the fusion of Node and Ruby is pretty sweet.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Deploy Yeoman App on Heroku]]></title>
    <link href="http://jaketrent.com/post/yeoman-app-on-heroku/"/>
    <updated>2013-04-23T07:12:00-06:00</updated>
    <id>http://jaketrent.com/post/yeoman-app-on-heroku</id>
    <content type="html"><![CDATA[<p>Yeoman is great developer tool that will help you generate a project format that is easy to get up and running quickly.  Out of the box, Yeoman only generates static sites.  But, with a few small tweaks, you can get it running on an app server, Nodejs, and up on Heroku.</p>

<p><img src="http://i.imgur.com/1Mc2kXh.jpg" alt="Yeoman" /></p>

<!--more-->


<h2>New Project With Yeoman</h2>

<p>To install Yeoman, run:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm install -g yo</span></code></pre></td></tr></table></div></figure>


<p>Now navigate to your new project directory and generate the scaffolding by running:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yo webapp</span></code></pre></td></tr></table></div></figure>


<p>There are other generators, specifically for angularjs or a handful of other frameworks.  To see more options, run:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yo --help</span></code></pre></td></tr></table></div></figure>


<h2>Add Node for Heroku</h2>

<p>Since Yeoman creates a static site, it should be read to serve out of any old web server.  But Heroku specifically wants an app server.  Node is one of the options, and it&#8217;s a great option for a lightweight app server.</p>

<p>To get the node dependencies you need, create a <code>package.json</code> via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm init</span></code></pre></td></tr></table></div></figure>


<p>Then pull down the dependencies you&#8217;ll need:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm install gzippo express coffee-script --save</span></code></pre></td></tr></table></div></figure>


<p>Now create your app server, <code>web.coffee</code>.  It&#8217;s about as light as they come:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">gzippo = </span><span class="nx">require</span> <span class="s">&#39;gzippo&#39;</span>
</span><span class='line'><span class="nv">express = </span><span class="nx">require</span> <span class="s">&#39;express&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">app = </span><span class="nx">express</span><span class="p">()</span>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">use</span> <span class="nx">express</span><span class="p">.</span><span class="nx">logger</span> <span class="s">&#39;dev&#39;</span>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">use</span> <span class="nx">gzippo</span><span class="p">.</span><span class="nx">staticGzip</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">__dirname</span><span class="si">}</span><span class="s">/dist&quot;</span>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">listen</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span> <span class="o">||</span> <span class="mi">5000</span>
</span></code></pre></td></tr></table></div></figure>


<p>It&#8217;s going to be serving the static resources that you build w/ Yeoman/Grunt that end up in the <code>dist</code> directory.  In order for code to get to Heroku, it needs to be commited to your git repo.  Thus, you need to remove the &#8220;dist&#8221; line from your <code>.gitignore</code> file, and don&#8217;t forget to add and commit the files to git as you build them.  You may also have to add more tasks to the <code>Gruntfile.js</code> to copy over any other assets to <code>dist</code> that your app needs to run.</p>

<p>Finally create a <code>Procfile</code> file for Heroku in the root of your project that points to the <code>web.coffee</code> server:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>web: coffee web.coffee</span></code></pre></td></tr></table></div></figure>


<p>Now it&#8217;s time to push to Heroku.  You should have the Heroku Toolbelt installed and create a heroku url by running:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>heroku create &lt;my_project&gt;</span></code></pre></td></tr></table></div></figure>


<p>To test your yeoman app as it will be run in production, first build it:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>grunt build</span></code></pre></td></tr></table></div></figure>


<p>Then run the grunt server:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>grunt server:dist</span></code></pre></td></tr></table></div></figure>


<p>Or if you have foreman and want to run the app using your <code>Procfile</code>, run:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>foreman start</span></code></pre></td></tr></table></div></figure>


<p>It&#8217;s time.  Commit your code, especially that <code>dist</code> directory, and&#8230; deploy!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git push heroku master</span></code></pre></td></tr></table></div></figure>


<p>There are quite a few steps there.  What did we miss?  Or what needs more explanation?  Perhaps we just need a <code>yo heroku</code> target.</p>
]]></content>
  </entry>
  
</feed>
